var F=Object.defineProperty;var I=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var N=(i,e,s)=>e in i?F(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s,P=(i,e)=>{for(var s in e||(e={}))A.call(e,s)&&N(i,s,e[s]);if(I)for(var s of I(e))X.call(e,s)&&N(i,s,e[s]);return i};import{Q as j}from"./QSpace.196a214e.js";import{aE as z,_ as H,J,bz as K,r as v,i as W,bJ as G,a as C,F as w,G as b,N as r,aR as Z,M as n,W as M,aP as tt,I as y,R as c,P as a,q as et,Q as L,aH as q,U as at,V as ot,O as rt,aO as f,L as it}from"./index.4bd8ab7e.js";import{Q as lt,a as V,c as u,b as st}from"./QTable.87be80e4.js";import{C as nt}from"./ClosePopup.34597da2.js";import{f as T}from"./useFormat.349e799c.js";import{u as ct}from"./useI18n.96209f4d.js";import{E as mt}from"./export-detail-modal.2aae70ad.js";import{b as dt,c as ut}from"./axiosClient.ad61c203.js";import{Q as pt}from"./queryKeys.832af9fa.js";import{d as k}from"./date.525ad423.js";import{b as ft}from"./import-stock-edit-modal.523a9d4a.js";import"./QList.550b5ccf.js";import"./QSelect.2521a28c.js";import"./QMenu.d60d439b.js";import"./position-engine.e365a736.js";import"./selection.cdf30163.js";import"./QItemLabel.0748896a.js";import"./rtl.4b414a6d.js";import"./QForm.8a0c543d.js";import"./QToolbarTitle.dfdc5985.js";import"./QToolbar.06ebec8c.js";import"./QInnerLoading.36fa411b.js";import"./QDate.20311372.js";import"./use-cache.b0833c75.js";import"./QPopupProxy.0d4ba934.js";import"./use-quasar.fa06306f.js";import"./QTooltip.a00a2acf.js";import"./useCategoryServiceQuery.1a080013.js";import"./useNotify.6f32b3a1.js";const _t=k.formatDate(new Date,"DD/MM/YYYY"),Q=(i=_t)=>{const[e,s,_]=i.split("/");return`${_}/${s}/${e}`},yt=async i=>{const{data:e}=await dt.get(`/inventory/stock/getStockInventoryDetail?limit=10&startTime=${i.startTime.value?Number(k.formatDate(Q(i.startTime.value),"X")):Number(k.formatDate(Q(i.startWeek.value),"X"))}&productSn=${i.productSn}&endTime=${Number(k.formatDate(Q(i.endTime.value),"X"))}`);return e.data},vt=i=>z([pt.STOCK_INVENTORIES,{params:i}],()=>yt(i));const kt={class:"text-h6"},xt={class:"q-mb-md flex q-gutter-x-md text-weight-bold"},wt={key:0},Tt={class:"note"},Dt=J({setup(i){var E;const e=K(),s=v(),_=v(),{t:m}=ct(),R=W("emitter");(()=>{var o,d,t;(o=e==null?void 0:e.query)!=null&&o.startTime&&(s.value=(d=e==null?void 0:e.query)==null?void 0:d.startTime,_.value=(t=e==null?void 0:e.query)==null?void 0:t.endTime)})();const g=v(null),x=v(!1),h=v(null),O=(o,d)=>{var t,l;o===1?(x.value=!0,(t=g.value)==null||t.setupEditImportStockDialog(d)):(l=h.value)==null||l.open(d)},Y=()=>{x.value=!1,S(),R.emit("closeDetailInventory")},D=G(),{data:p,isLoading:$}=vt({startTime:s,endTime:_,productSn:(E=e==null?void 0:e.params)==null?void 0:E.productSn}),B=C(()=>p.value&&p.value.importExportStockList.length!==0?[...p.value.importExportStockList,{isLast:!0}]:void 0),U=C(()=>[{name:"receiptType",label:m("receipt_type"),field:o=>o.receiptType},{name:"dateTime",label:m("receipt_date_time"),field:o=>o.receiptDate},{name:"receiptSn",label:m("receipt_ID"),field:o=>o.receiptId},{name:"importQuantity",label:m("import_quantity"),field:o=>o.importQuantity},{name:"importPrice",label:m("import_price"),field:o=>o.importPrice},{name:"exportQuantity",label:m("export_quantity"),field:o=>o.exportQuantity},{name:"exportPrice",label:m("export_price"),field:o=>o.exportPrice},{name:"note",label:m("note"),field:o=>o.note}]),S=()=>D.replace({path:"/settings/stock/inventory",query:P({},e.query)});return(o,d)=>(w(),b(M,null,[r(Z,{"model-value":!0,onHide:S},{default:n(()=>[r(tt,{style:{width:"1360px","max-width":"80vw"}},{default:n(()=>[r(q,{class:"row items-center"},{default:n(()=>[y("div",kt,c(a(m)("import_export_detail")),1),r(j),et(r(L,{icon:"close",flat:"",round:"",dense:""},null,512),[[nt]])]),_:1}),r(q,{class:"q-pt-none"},{default:n(()=>[y("div",xt,[y("span",null,c(a(D).options.history.state.productName),1),y("span",null,c(a(m)("unit"))+": "+c(a(D).options.history.state.productUnitName),1),s.value&&_.value?(w(),b("div",wt,[y("span",null,c(a(m)("from"))+" "+c(s.value)+" "+c(a(m)("to"))+" "+c(_.value),1)])):at("v-if",!0)]),r(lt,{loading:a($),columns:a(U),rows:a(B),"rows-per-page-options":[0],"hide-pagination":"","hide-bottom":"","no-data-label":"No data",flat:""},{header:n(t=>[r(V,null,{default:n(()=>[(w(!0),b(M,null,ot(t.cols,l=>(w(),it(st,{key:l.name,props:t,class:"th"},{default:n(()=>[f(c(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1024)]),body:n(t=>[r(V,{props:t,class:rt(t.row.isLast?"bg-white text-weight-bolder":""),"no-hover":""},{default:n(()=>[r(u,{key:"receiptType",props:t,class:"td"},{default:n(()=>[f(c(t.row.isLast?a(m)("total"):t.row.receiptType===1?a(m)("import_stock"):t.row.receiptType===2?a(m)("export_stock"):""),1)]),_:2},1032,["props"]),r(u,{key:"dateTime",props:t,class:"td"},{default:n(()=>[f(c(a(k).formatDate(t.row.receiptDate*1e3,a(ut))),1)]),_:2},1032,["props"]),r(u,{key:"receiptSn",props:t,class:"td"},{default:n(()=>[r(L,{label:t.row.receiptId,flat:"",dense:"",color:"orange-10",onClick:l=>O(t.row.receiptType,t.row.stockSn)},null,8,["label","onClick"])]),_:2},1032,["props"]),r(u,{key:"importQuantity",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?(l=a(p))==null?void 0:l.total.importQuantity:t.row.importQuantity),1)]}),_:2},1032,["props"]),r(u,{key:"importPrice",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?a(T)((l=a(p))==null?void 0:l.total.importPrice):a(T)(t.row.importPrice))+" VND ",1)]}),_:2},1032,["props"]),r(u,{key:"exportQuantity",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?(l=a(p))==null?void 0:l.total.exportQuantity:t.row.exportQuantity),1)]}),_:2},1032,["props"]),r(u,{key:"exportPrice",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?a(T)((l=a(p))==null?void 0:l.total.exportPrice):a(T)(t.row.exportPrice))+" VND ",1)]}),_:2},1032,["props"]),r(u,{key:"note",props:t,class:"td"},{default:n(()=>[y("p",Tt,c(t.row.note),1)]),_:2},1032,["props"])]),_:2},1032,["props","class"])]),_:1},8,["loading","columns","rows"])]),_:1})]),_:1})]),_:1}),r(mt,{ref_key:"exportDetailModal",ref:h},null,512),r(ft,{ref_key:"importStockEditModal",ref:g,modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=t=>x.value=t),onClose:Y},null,8,["modelValue"])],64))}});var te=H(Dt,[["__scopeId","data-v-d4130e6e"],["__file","D:/project_learn/goPMS/src/modules/stock/inventory/pages/detail.vue"]]);export{te as default};
