import{Q as I}from"./QSelect.2521a28c.js";import{Q as M}from"./QDate.20311372.js";import{Q as P}from"./QPopupProxy.0d4ba934.js";import{aE as A,_ as O,r as f,C as U,a as S,w as V,K as Q,F as h,L as B,M as n,I as d,R as m,N as a,G as N,U as T,T as q,bq as C,aO as g}from"./index.4bd8ab7e.js";import{a as X}from"./QMenu.d60d439b.js";import{Q as K}from"./QInnerLoading.36fa411b.js";import{a as L,c as b,Q as j}from"./QTable.87be80e4.js";import{Q as Y}from"./QPagination.952d6437.js";import{u as z}from"./useI18n.96209f4d.js";import{u as J}from"./useAppendixQuery.627eefb9.js";import{b as G,e as x,c as H,d as W}from"./axiosClient.ad61c203.js";import{Q as Z}from"./queryKeys.832af9fa.js";import{a as $,f as ee}from"./useFormat.349e799c.js";import{d as i}from"./date.525ad423.js";import"./selection.cdf30163.js";import"./QItemLabel.0748896a.js";import"./rtl.4b414a6d.js";import"./use-cache.b0833c75.js";import"./position-engine.e365a736.js";import"./QList.550b5ccf.js";const te=async({queryKey:r})=>{const[,t]=r;if((t==null?void 0:t.startDate)&&(t==null?void 0:t.endDate)){const{data:u}=await G.get("/report/getDebtSummaryList",{params:t});return u.data}},oe=(r,t)=>{const u=[Z.DEBT_SUMMARY_REPORT,r];return A(u,te,{enabled:t,select:e=>e})};const ae={setup(){const{t:r,locale:t}=z(),{data:u,isFetching:e}=J({enabled:!0}),D=f(Date.now()),s=U({page:1,limit:10,bookingSourceSn:null,startDate:Number(i.formatDate(D.value,"X")),endDate:Number(i.formatDate(D.value,"X"))}),{data:y,isFetching:w}=oe(s,!0),l=f(null),_=f(0),o=()=>{l==null||l.value.show()},p=S({get:()=>({from:s.startDate?i.formatDate(new Date(s.startDate*1e3),x):"",to:s.endDate?i.formatDate(new Date(s.endDate*1e3),x):""}),set:c=>{_.value=0,c?(s.startDate=Number(i.formatDate(new Date(c.from),"X"))||Number(i.formatDate(new Date(c),"X")),s.endDate=Number(i.formatDate(new Date(c.to),"X"))||Number(i.formatDate(new Date(c),"X"))):s.startDate=s.endDate=null,k()}}),R=S(()=>[{name:"no",label:r("no"),align:"left",field:""},{name:"bookingSourceName",label:r("booking_sources"),align:"left",field:"bookingSourceName"},{name:"debtStarting",align:"right",label:r("debt_starting_balance"),field:"debtStarting"},{name:"debtPeriod",align:"right",label:r("debt_in_the_period"),field:"debtPeriod"},{name:"debtEnd",align:"right",label:r("debt_end_balance"),field:"debtEnd"}]),k=()=>{s.page=1},v=f([]);V(e,()=>{E()});const E=()=>{v.value.push({name:r("all_booking_sources"),sn:null},...JSON.parse(JSON.stringify(u.value)))},F=f("");return V(()=>t.value,c=>{F.value=c,v.value[0]={name:r("all_booking_sources"),sn:null}}),{t:r,columns:R,data:y,isFetching:w,formatIndexTable:$,dateRangeType:_,onOpenDatePopUp:o,qDateRef:l,dateRange:p,formValues:s,useBookingSourcesFetching:e,FORMAT_DATE_TIME_UI:H,FORMAT_DATE_UI:W,date:i,onApply:k,arrayBookingSources:v,formatMoney:ee}}},ne={class:"row q-mb-md"},re={class:"text-h5 text-bold"},se={class:"row q-mb-md q-gutter-md"},le={style:{"min-width":"16%"}},ie={style:{"min-width":"16%"}},de={key:0,class:"self-center full-width no-outline",tabindex:"0"},me={class:"relative-position"},ce={lass:"full-width","full-height":"",class:"q-mt-md row justify-center"},ue={key:0},_e={class:"q-mt-md row justify-end"};function fe(r,t,u,e,D,s){const y=Q("router-link"),w=Q("pms-sections");return h(),B(w,null,{header:n(()=>[d("div",ne,[d("div",re,m(e.t("debt_summary_report")),1)]),d("div",se,[d("div",le,[a(I,{modelValue:e.formValues.bookingSourceSn,"onUpdate:modelValue":[t[0]||(t[0]=l=>e.formValues.bookingSourceSn=l),t[1]||(t[1]=l=>e.onApply())],loading:e.useBookingSourcesFetching,filled:"",dense:"",options:e.arrayBookingSources,"option-value":"sn","option-label":"name","map-options":"","emit-value":""},null,8,["modelValue","loading","options"])]),d("div",ie,[a(X,{placeholder:e.t("select_date_time"),dense:"","stack-label":"",filled:"",onFocus:e.onOpenDatePopUp},{control:n(()=>[e.dateRange.from&&e.dateRange.to?(h(),N("div",de,m(e.date.formatDate(e.dateRange.from,e.FORMAT_DATE_UI))+" - "+m(e.date.formatDate(e.dateRange.to,e.FORMAT_DATE_UI)),1)):T("v-if",!0)]),prepend:n(()=>[a(q,{name:"event",class:"no-pointer-events"},{default:n(()=>[a(P,{ref:"qDateRef","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[a(M,{modelValue:e.dateRange,"onUpdate:modelValue":t[2]||(t[2]=l=>e.dateRange=l),range:""},null,8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["placeholder","onFocus"])])])]),default:n(()=>{var l,_;return[d("div",me,[a(K,{showing:e.isFetching,label:"Please","label-class":"text-teal","label-style":"font-size:1.1em"},{default:n(()=>[d("div",ce,[a(C,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"]),e.isFetching?T("v-if",!0):(h(),N("div",ue,[a(j,{"rows-per-page-options":[0],rows:(l=e.data)==null?void 0:l.debtSummaryList,columns:e.columns,"hide-pagination":"","hide-bottom":"","row-key":"no"},{body:n(o=>[a(L,{props:o},{default:n(()=>[a(b,{key:"no",props:o},{default:n(()=>[g(m(e.formatIndexTable(e.formValues.page,o.rowIndex)),1)]),_:2},1032,["props"]),a(b,{key:"bookingSourceName",props:o},{default:n(()=>{var p;return[a(y,{style:{"text-decoration":"none"},class:"custom-link text-negative",to:{name:"debt-detail-report",params:{sn:(p=o.row)==null?void 0:p.bookingSourceSn},query:e.formValues}},{default:n(()=>[g(m(o.row.bookingSourceName),1)]),_:2},1032,["to"])]}),_:2},1032,["props"]),a(b,{key:"debtStarting",props:o},{default:n(()=>[g(m(e.formatMoney(o.row.debtStarting))+" VND ",1)]),_:2},1032,["props"]),a(b,{key:"debtPeriod",props:o},{default:n(()=>[g(m(e.formatMoney(o.row.debtPeriod))+" VND ",1)]),_:2},1032,["props"]),a(b,{key:"debtEnd",props:o},{default:n(()=>[g(m(e.formatMoney(o.row.debtEnd))+" VND ",1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),d("div",_e,[a(Y,{modelValue:e.formValues.page,"onUpdate:modelValue":t[3]||(t[3]=o=>e.formValues.page=o),color:"negative",max:((_=e.data)==null?void 0:_.meta.lastPage)||1,"max-pages":5,"boundary-numbers":"","direction-links":"",push:""},null,8,["modelValue","max"])])]))])]}),_:1})}var Pe=O(ae,[["render",fe],["__scopeId","data-v-73243be9"],["__file","D:/project_learn/goPMS/src/modules/report/debt-summary-report/view.vue"]]);export{Pe as default};
