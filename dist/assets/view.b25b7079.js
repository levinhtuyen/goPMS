import{Q as te}from"./QInnerLoading.36fa411b.js";import{aE as oe,aF as se,bj as le,_ as ae,bM as ie,r as u,bA as ne,K as re,F as m,L as T,M as s,I as o,R as n,G as S,N as t,aP as x,aH as Q,am as de,aN as F,aI as _,U as ue,T as g,q as b,Q as f,O as ce}from"./index.4bd8ab7e.js";import{Q as me}from"./QSelect.2521a28c.js";import{Q as w}from"./QTime.12b67e2f.js";import{Q as O}from"./QPopupProxy.0d4ba934.js";import{Q as _e}from"./QForm.8a0c543d.js";import{C as U}from"./ClosePopup.34597da2.js";import{b as N,u as fe}from"./axiosClient.ad61c203.js";import{Q as L}from"./queryKeys.832af9fa.js";import{u as ve}from"./useI18n.96209f4d.js";import{u as pe}from"./useNotify.6f32b3a1.js";import"./QMenu.d60d439b.js";import"./position-engine.e365a736.js";import"./selection.cdf30163.js";import"./QItemLabel.0748896a.js";import"./rtl.4b414a6d.js";import"./TouchPan.3d5b23e3.js";import"./touch.70a9dd44.js";import"./date.525ad423.js";import"./use-quasar.fa06306f.js";const he=async()=>{const{data:r}=await N.get("/configuration/policy/getPolicy");return r.data},ye=()=>oe(L.POLICIES,he),Ve=async r=>{const{data:l}=await N.post("/configuration/policy/updatePolicy",r);return l.data},ge=()=>{const r=le();return se(Ve,{onSuccess:()=>{r.invalidateQueries(L.POLICIES)}})},be={components:{pmsSections:ie},setup(){const{t:r}=ve(),{hasPermission:l}=fe(),{mutate:P,isLoading:e}=ge(),c=u({countrySn:0,currency:"",endDaily:"",endOvernight:"",hotelSn:0,roundUpHour:0,policySn:0,startDaily:"",startOvernight:""});let{data:d,isLoading:D}=ye();const{notifySaveSuccess:a}=pe(),q=u(),v=u(null),z=()=>{v==null||v.value.show()},p=u(null),B=()=>{p==null||p.value.show()},h=u(null),M=()=>{h==null||h.value.show()},y=u(null),A=()=>{y==null||y.value.show()};ne(()=>{var i,V,C,H,k,j,R,E,I;d.value&&(c.value={countrySn:(i=d.value)==null?void 0:i.countrySn,currency:(V=d.value)==null?void 0:V.currency,endDaily:(C=d.value)==null?void 0:C.endDaily,endOvernight:(H=d.value)==null?void 0:H.endOvernight,hotelSn:(k=d.value)==null?void 0:k.hotelSn,roundUpHour:(j=d.value)==null?void 0:j.roundUpHour,policySn:(R=d.value)==null?void 0:R.sn,startDaily:(E=d.value)==null?void 0:E.startDaily,startOvernight:(I=d.value)==null?void 0:I.startOvernight})});const K=u(null),Y=[i=>!!i||r("this_field_is_required")],G=u(null),J=[i=>!!i||r("this_field_is_required")],W=u(null),X=[i=>!!i||r("this_field_is_required")],Z=u(null),$=[i=>!!i||r("this_field_is_required")],ee=()=>{var i;(i=q.value)==null||i.validate().then(V=>{if(V&&Number(c.value.roundUpHour)>1&&Number(c.value.roundUpHour)<59)P(c.value,{onSuccess:()=>{a()}});else return!1})};return{group:u(null),t:r,isLoading:D,currencyOptions:[{label:"VND",value:1}],formValues:c,startDailyField:K,startDailyRules:Y,endDailyField:G,endDailyRules:J,startOvernightField:W,startOvernightRules:X,endOvernightField:Z,endOvernightRules:$,onSubmit:ee,updatePolicyFormRef:q,isSubmitting:e,hasPermission:l,qOvernightStartTimeRef:v,onOpenOvernightStartTimePopUp:z,qOvernightEndTimeRef:p,onOpenOvernightEndTimePopUp:B,qDailyStartTimeRef:h,onOpenDailyStartTimePopUp:M,qDailyEndTimeRef:y,onOpenDailyEndTimePopUp:A}}},we={class:"row q-pb-md"},Oe={class:"text-h5 text-bold"},Ue={key:1,class:""},De={class:"row"},Se={class:"col-12 col-md-6 q-pr-sm"},xe={class:"text-subtitle1 text-white text-bold"},Qe={class:"row items-baseline justify-between"},Fe={class:"text-weight-bold"},Pe={class:"row items-baseline justify-between",style:{width:"9em"}},qe={key:0,class:"row justify-end text-red"},Ce={key:1,class:"row justify-end text-red"},He={class:"row items-baseline justify-between"},ke={class:"text-weight-bold"},je={class:"row",style:{width:"9em"}},Re={class:"col-12 col-md-6 q-pl-sm"},Ee={class:"text-subtitle1 text-white text-bold"},Ie={class:"row"},Te={class:"col-12 col-md-6 q-pa-sm"},Ne={class:"text-bold"},Le={class:"row items-center justify-end"},ze={class:"col-12 col-md-6 q-pa-sm"},Be={class:"text-bold"},Me={class:"row items-center justify-end"},Ae={class:"text-subtitle1 text-white text-bold"},Ke={class:"row"},Ye={class:"col-12 col-md-6 q-pa-sm"},Ge={class:"text-bold"},Je={class:"row items-center justify-end"},We={class:"col-12 col-md-6 q-pa-sm"},Xe={class:"text-bold"},Ze={class:"row items-center justify-end"},$e={class:"flex justify-end"};function et(r,l,P,e,c,d){const D=re("pms-sections");return m(),T(D,null,{header:s(()=>[o("div",we,[o("div",Oe,n(e.t("policy")),1)])]),default:s(()=>[e.isLoading?(m(),T(te,{key:0,showing:"",color:"red"})):(m(),S("div",Ue,[t(_e,{ref:"updatePolicyFormRef"},{default:s(()=>[o("div",De,[o("div",Se,[t(x,{class:"q-mb-sm"},{default:s(()=>[t(Q,{class:"bg-negative q-pa-sm"},{default:s(()=>[o("div",xe,n(e.t("general_setting")),1)]),_:1}),t(de),t(F,{vertical:""},{default:s(()=>[o("div",Qe,[o("p",Fe,n(e.t("hour_round_up")),1),o("div",Pe,[o("p",null,[t(_,{modelValue:e.formValues.roundUpHour,"onUpdate:modelValue":l[0]||(l[0]=a=>e.formValues.roundUpHour=a),"lazy-rules":"",dense:"",outlined:"",mask:"##",style:{width:"3.5em"}},null,8,["modelValue"])]),o("p",null,n(e.t("minutes")),1)])]),e.formValues.roundUpHour?e.formValues.roundUpHour<1||e.formValues.roundUpHour>59?(m(),S("p",Ce,n(e.t("the_value_is_from_1_to_59")),1)):ue("v-if",!0):(m(),S("p",qe,n(e.t("this_field_is_required")),1)),o("div",He,[o("p",ke,n(e.t("select_currency")),1),o("div",je,[t(me,{modelValue:e.formValues.countrySn,"onUpdate:modelValue":l[1]||(l[1]=a=>e.formValues.countrySn=a),outlined:"",dense:"",style:{width:"100%"},options:e.currencyOptions,"emit-value":"","map-options":"","option-label":"label","option-value":"value"},null,8,["modelValue","options"])])])]),_:1})]),_:1})]),o("div",Re,[t(x,{class:"q-mb-sm"},{default:s(()=>[t(Q,{class:"bg-negative q-pa-sm"},{default:s(()=>[o("div",Ee,n(e.t("overnight")),1)]),_:1}),t(F,{vertical:""},{default:s(()=>[o("div",Ie,[o("div",Te,[o("p",Ne,n(e.t("overnight_start_time")),1),t(_,{ref:"startOvernightField",modelValue:e.formValues.startOvernight,"onUpdate:modelValue":l[3]||(l[3]=a=>e.formValues.startOvernight=a),"lazy-rules":"",rules:e.startOvernightRules,mask:"time",dense:"",outlined:"",onFocus:e.onOpenOvernightStartTimePopUp},{append:s(()=>[t(g,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[t(O,{ref:"qOvernightStartTimeRef",cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[t(w,{modelValue:e.formValues.startOvernight,"onUpdate:modelValue":l[2]||(l[2]=a=>e.formValues.startOvernight=a),mask:"HH:mm",format24h:""},{default:s(()=>[o("div",Le,[b(t(f,{label:"Close",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules","onFocus"])]),o("div",ze,[o("p",Be,n(e.t("overnight_end_time")),1),t(_,{ref:"endOvernightField",modelValue:e.formValues.endOvernight,"onUpdate:modelValue":l[5]||(l[5]=a=>e.formValues.endOvernight=a),"lazy-rules":"",rules:e.endOvernightRules,mask:"time",dense:"",outlined:"",onFocus:e.onOpenOvernightEndTimePopUp},{append:s(()=>[t(g,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[t(O,{ref:"qOvernightEndTimeRef",cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[t(w,{modelValue:e.formValues.endOvernight,"onUpdate:modelValue":l[4]||(l[4]=a=>e.formValues.endOvernight=a),mask:"HH:mm",format24h:""},{default:s(()=>[o("div",Me,[b(t(f,{label:"Close",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules","onFocus"])])])]),_:1})]),_:1}),t(x,{class:"q-mb-md"},{default:s(()=>[t(Q,{class:"bg-negative q-pa-sm"},{default:s(()=>[o("div",Ae,n(e.t("daily")),1)]),_:1}),t(F,{vertical:""},{default:s(()=>[o("div",Ke,[o("div",Ye,[o("p",Ge,n(e.t("daily_start_time")),1),t(_,{ref:"startDailyField",modelValue:e.formValues.startDaily,"onUpdate:modelValue":l[7]||(l[7]=a=>e.formValues.startDaily=a),"lazy-rules":"",rules:e.startDailyRules,mask:"time",dense:"",outlined:"",onFocus:e.onOpenDailyStartTimePopUp},{append:s(()=>[t(g,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[t(O,{ref:"qDailyStartTimeRef",cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[t(w,{modelValue:e.formValues.startDaily,"onUpdate:modelValue":l[6]||(l[6]=a=>e.formValues.startDaily=a),mask:"HH:mm",format24h:""},{default:s(()=>[o("div",Je,[b(t(f,{label:"Close",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules","onFocus"])]),o("div",We,[o("p",Xe,n(e.t("daily_end_time")),1),t(_,{ref:"endDailyField",modelValue:e.formValues.endDaily,"onUpdate:modelValue":l[9]||(l[9]=a=>e.formValues.endDaily=a),"lazy-rules":"",rules:e.endDailyRules,mask:"time",dense:"",outlined:"",onFocus:e.onOpenDailyEndTimePopUp},{append:s(()=>[t(g,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[t(O,{ref:"qDailyEndTimeRef",cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[t(w,{modelValue:e.formValues.endDaily,"onUpdate:modelValue":l[8]||(l[8]=a=>e.formValues.endDaily=a),mask:"HH:mm",format24h:""},{default:s(()=>[o("div",Ze,[b(t(f,{label:"Close",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules","onFocus"])])])]),_:1})]),_:1})])])]),_:1},512),o("div",$e,[t(f,{"no-caps":"",class:ce(["q-px-lg",e.hasPermission("edit-policy")==!1?"hidden":""]),color:"negative",label:e.t("save"),loading:e.isSubmitting,type:"submit",onClick:e.onSubmit},null,8,["label","loading","class","onClick"])])]))]),_:1})}var bt=ae(be,[["render",et],["__file","D:/project_learn/goPMS/src/modules/policies/view.vue"]]);export{bt as default};
