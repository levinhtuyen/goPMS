import{Q as q}from"./QSelect.8edab530.js";import{Q as O}from"./QDate.804040fd.js";import{Q as P}from"./QPopupProxy.9996c4ad.js";import{av as M,_ as E,bx as I,r as N,C as U,a as V,K as R,F as x,L as B,M as l,I as t,R as i,N as n,G as S,U as A,T as C,bo as X,aF as d}from"./index.7efcbe86.js";import{a as j}from"./QMenu.b19dfcca.js";import{Q as K}from"./QInnerLoading.5fef3982.js";import{a as L,c as f,Q as Y}from"./QTable.4cc8e1c9.js";import{Q as k}from"./QTooltip.c975c2a0.js";import{Q as z}from"./QPagination.a48c1bef.js";import{u as G}from"./useI18n.6b7b36de.js";import{u as H}from"./useAppendixQuery.039c05de.js";import{b as J,e as F,d as W}from"./axiosClient.a0ee23b9.js";import{Q as Z}from"./queryKeys.832af9fa.js";import{a as $,f as ee}from"./useFormat.349e799c.js";import{d as c}from"./date.2d51ed98.js";import{n as te}from"./useCreateDate.6141d343.js";import"./selection.6afffe69.js";import"./QItemLabel.938a9258.js";import"./rtl.4b414a6d.js";import"./use-cache.b0833c75.js";import"./position-engine.4a23d733.js";import"./QList.e5651779.js";const oe=async({queryKey:s})=>{const[,o]=s;if((o==null?void 0:o.startDate)&&(o==null?void 0:o.endDate)){const{data:_}=await J.get("/report/getDebtDetailList",{params:o});return _.data}},ae=(s,o)=>{const _=[Z.DEBT_SUMMARY_REPORT,s];return M(_,oe,{enabled:o,select:e=>e})},ne={setup(){const{t:s}=G(),o=I(),{data:_,isFetching:e}=H({enabled:!0}),v=N(Date.now()),r=U({page:1,limit:10,bookingSourceSn:Number(o.params.sn)||"",startDate:o.query.startDate?Number(o.query.startDate):Number(c.formatDate(v.value,"X")),endDate:o.query.startDate?Number(o.query.endDate):Number(c.formatDate(v.value,"X"))}),b=N(null),p=N(0),{data:m,isFetching:D}=ae(r,!0),w=()=>{b==null||b.value.show()},y=V({get:()=>({from:r.startDate?c.formatDate(new Date(r.startDate*1e3),F):"",to:r.endDate?c.formatDate(new Date(r.endDate*1e3),F):""}),set:u=>{p.value=0,u?(r.startDate=Number(c.formatDate(new Date(u.from),"X"))||Number(c.formatDate(new Date(u),"X")),r.endDate=Number(c.formatDate(new Date(u.to),"X"))||Number(c.formatDate(new Date(u),"X"))):r.startDate=r.endDate=null,g()}}),h=V(()=>[{name:"no",label:s("no"),align:"left",field:""},{name:"checkOutActual",label:s("checked_out_date"),align:"left",field:"checkOutActual"},{name:"sn",align:"left",label:s("booking_no"),field:"sn"},{name:"fullName",align:"left",label:s("guest_name"),field:"fullName"},{name:"roomTypeName",align:"left",label:s("room_types"),field:"roomTypeName"},{name:"roomName",align:"left",label:s("rooms"),field:"roomName"},{name:"debtPrice",align:"right",label:s("debt_price"),field:"debtPrice"},{name:"note",align:"left",label:s("booking_note"),field:"note"}]),g=()=>{r.page=1};return{t:s,columns:h,data:m,isFetching:D,formatIndexTable:$,dateRangeType:p,onOpenDatePopUp:w,qDateRef:b,dateRange:y,formValues:r,bookingSourceOptions:_,useBookingSourcesFetching:e,FORMAT_DATE_UI:W,newDateStamp:te,date:c,onApply:g,formatMoney:ee}}},le={class:"q-px-md q-pb-lg row"},ie={class:"text-h5 text-bold"},se={class:"q-px-md q-pb-lg row q-gutter-md"},re={style:{"min-width":"16%"}},de={style:{"min-width":"16%"}},me={key:0,class:"self-center full-width no-outline",tabindex:"0"},ce={class:"relative-position"},ue={lass:"full-width","full-height":"",class:"q-mt-md row justify-center"},fe={key:0,class:"q-px-md"},_e={class:"ellipsis",style:{width:"300px"}},be={class:"ellipsis",style:{width:"300px"}},ge={class:"ellipsis",style:{width:"300px"}},pe={class:"ellipsis",style:{width:"300px"}},De={class:"q-py-md row justify-end"},we={class:"q-px-md q-px-md q-pt-md text-bold",style:{background:"#fff3eb"}},ye={class:"row justify-between"},he={class:"row justify-between"},ke={class:"row justify-between"};function ve(s,o,_,e,v,r){const b=R("router-link"),p=R("pms-sections");return x(),B(p,null,{header:l(()=>[t("div",le,[t("div",ie,i(e.t("debt_detail_report")),1)]),t("div",se,[t("div",re,[n(q,{modelValue:e.formValues.bookingSourceSn,"onUpdate:modelValue":[o[0]||(o[0]=m=>e.formValues.bookingSourceSn=m),o[1]||(o[1]=m=>e.onApply())],loading:e.useBookingSourcesFetching,outlined:"",dense:"",options:e.bookingSourceOptions,"option-value":"sn","option-label":"name","map-options":"","emit-value":"",placeholder:"Select Booking Source"},null,8,["modelValue","loading","options"])]),t("div",de,[n(j,{placeholder:"Select date time",dense:"","stack-label":"",outlined:"",onFocus:e.onOpenDatePopUp},{control:l(()=>[e.dateRange.from&&e.dateRange.to?(x(),S("div",me,i(e.date.formatDate(e.dateRange.from,e.FORMAT_DATE_UI))+" - "+i(e.date.formatDate(e.dateRange.to,e.FORMAT_DATE_UI)),1)):A("v-if",!0)]),prepend:l(()=>[n(C,{name:"event",class:"no-pointer-events"},{default:l(()=>[n(P,{ref:"qDateRef","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[n(O,{modelValue:e.dateRange,"onUpdate:modelValue":o[2]||(o[2]=m=>e.dateRange=m),range:""},null,8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["onFocus"])])])]),default:l(()=>{var m,D,w,y,h,g,u,T;return[t("div",ce,[n(K,{showing:e.isFetching,label:"Please","label-class":"text-teal","label-style":"font-size:1.1em"},{default:l(()=>[t("div",ue,[n(X,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"]),e.isFetching?A("v-if",!0):(x(),S("div",fe,[n(Y,{"rows-per-page-options":[0],rows:(m=e.data)==null?void 0:m.debtDetailList,columns:e.columns,"hide-pagination":"","hide-bottom":"","row-key":"no"},{body:l(a=>[n(L,{props:a},{default:l(()=>[n(f,{key:"no",props:a},{default:l(()=>[d(i(e.formatIndexTable(e.formValues.page,a.rowIndex)),1)]),_:2},1032,["props"]),n(f,{key:"checkOutActual",props:a},{default:l(()=>[d(i(e.newDateStamp(a.row.checkOutActual,e.FORMAT_DATE_UI)),1)]),_:2},1032,["props"]),n(f,{key:"sn",props:a},{default:l(()=>{var Q;return[n(b,{style:{"text-decoration":"none"},class:"custom-link text-negative",to:{name:"BookingDetails",params:{sn:(Q=a.row)==null?void 0:Q.sn}}},{default:l(()=>[d(i(a.row.bookingNo),1)]),_:2},1032,["to"])]}),_:2},1032,["props"]),n(f,{key:"fullName",props:a},{default:l(()=>[t("div",_e,[t("span",null,[n(k,null,{default:l(()=>[d(i(a.row.fullName),1)]),_:2},1024),d(" "+i(a.row.fullName),1)])])]),_:2},1032,["props"]),n(f,{key:"roomTypeName",props:a},{default:l(()=>[t("div",be,[t("span",null,[n(k,null,{default:l(()=>[d(i(a.row.roomTypeName),1)]),_:2},1024),d(" "+i(a.row.roomTypeName),1)])])]),_:2},1032,["props"]),n(f,{key:"roomName",props:a},{default:l(()=>[t("div",ge,[t("span",null,[n(k,null,{default:l(()=>[d(i(a.row.roomName),1)]),_:2},1024),d(" "+i(a.row.roomName),1)])])]),_:2},1032,["props"]),n(f,{key:"debtPrice",props:a},{default:l(()=>[d(i(e.formatMoney(a.row.debtPrice))+" VND ",1)]),_:2},1032,["props"]),n(f,{key:"note",props:a},{default:l(()=>[t("div",pe,[t("span",null,[n(k,null,{default:l(()=>[d(i(a.row.note),1)]),_:2},1024),d(" "+i(a.row.note),1)])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),t("div",De,[n(z,{modelValue:e.formValues.page,"onUpdate:modelValue":o[3]||(o[3]=a=>e.formValues.page=a),color:"negative",max:((D=e.data)==null?void 0:D.meta.lastPage)||1,"max-pages":5,"boundary-numbers":"","direction-links":"",push:""},null,8,["modelValue","max"])]),t("div",we,[t("div",ye,[t("p",null,"1. "+i(e.t("debt_starting_balance")),1),t("p",null,i(e.formatMoney((y=(w=e.data)==null?void 0:w.additionalData)==null?void 0:y.debtStarting))+" VND",1)]),t("div",he,[t("p",null,"2. "+i(e.t("debt_in_the_period")),1),t("p",null,i(e.formatMoney((g=(h=e.data)==null?void 0:h.additionalData)==null?void 0:g.debtPeriod))+" VND",1)]),t("div",ke,[t("p",null,"3. "+i(e.t("debt_end_balance_1_2")),1),t("p",null,i(e.formatMoney((T=(u=e.data)==null?void 0:u.additionalData)==null?void 0:T.debtEnd))+" VND",1)])])]))])]}),_:1})}var Ye=E(ne,[["render",ve],["__file","D:/gopms-web/src/modules/report/debt-detail-report/view.vue"]]);export{Ye as default};
