var U=Object.defineProperty;var E=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var N=(i,e,s)=>e in i?U(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s,C=(i,e)=>{for(var s in e||(e={}))A.call(e,s)&&N(i,s,e[s]);if(E)for(var s of E(e))X.call(e,s)&&N(i,s,e[s]);return i};import{Q as G}from"./QSpace.c00d4884.js";import{av as J,_ as K,J as W,bx as j,r as v,i as z,bJ as H,a as M,F as w,G as D,N as r,aI as Z,M as n,W as P,aG as tt,I as y,R as c,P as a,q as et,Q as L,ay as q,U as at,V as ot,O as rt,aF as f,L as it}from"./index.7efcbe86.js";import{Q as lt,a as V,c as u,b as st}from"./QTable.4cc8e1c9.js";import{C as nt}from"./ClosePopup.145acd40.js";import{f as T}from"./useFormat.349e799c.js";import{u as ct}from"./useI18n.6b7b36de.js";import{E as mt}from"./export-detail-modal.7f237d80.js";import{b as dt,c as ut}from"./axiosClient.a0ee23b9.js";import{Q as pt}from"./queryKeys.832af9fa.js";import{d as x}from"./date.2d51ed98.js";import{b as ft}from"./import-stock-edit-modal.63328578.js";import"./QList.e5651779.js";import"./QSelect.8edab530.js";import"./QMenu.b19dfcca.js";import"./position-engine.4a23d733.js";import"./selection.6afffe69.js";import"./QItemLabel.938a9258.js";import"./rtl.4b414a6d.js";import"./QForm.df816fa6.js";import"./QToolbarTitle.6428114f.js";import"./QToolbar.1dcdb2c5.js";import"./QInnerLoading.5fef3982.js";import"./QDate.804040fd.js";import"./use-cache.b0833c75.js";import"./QPopupProxy.9996c4ad.js";import"./use-quasar.f3f15168.js";import"./QTooltip.c975c2a0.js";import"./useCategoryServiceQuery.9c0b8426.js";import"./useNotify.967ca7e7.js";const _t=x.formatDate(new Date,"DD/MM/YYYY"),Q=(i=_t)=>{const[e,s,_]=i.split("/");return`${_}/${s}/${e}`},yt=async i=>{const{data:e}=await dt.get(`/inventory/stock/getStockInventoryDetail?limit=10&startTime=${i.startTime.value?Number(x.formatDate(Q(i.startTime.value),"X")):Number(x.formatDate(Q(i.startWeek.value),"X"))}&productSn=${i.productSn}&endTime=${Number(x.formatDate(Q(i.endTime.value),"X"))}`);return e.data},vt=i=>J([pt.STOCK_INVENTORIES,{params:i}],()=>yt(i));const xt={class:"text-h6"},kt={class:"q-mb-md flex q-gutter-x-md text-weight-bold"},wt={key:0},Tt={class:"note"},bt=W({setup(i){var I;const e=j(),s=v(),_=v(),{t:m}=ct(),R=z("emitter");(()=>{var o,d,t;(o=e==null?void 0:e.query)!=null&&o.startTime&&(s.value=(d=e==null?void 0:e.query)==null?void 0:d.startTime,_.value=(t=e==null?void 0:e.query)==null?void 0:t.endTime)})();const g=v(null),k=v(!1),h=v(null),Y=(o,d)=>{var t,l;o===1?(k.value=!0,(t=g.value)==null||t.setupEditImportStockDialog(d)):(l=h.value)==null||l.open(d)},$=()=>{k.value=!1,S(),R.emit("closeDetailInventory")},b=H(),{data:p,isLoading:O}=vt({startTime:s,endTime:_,productSn:(I=e==null?void 0:e.params)==null?void 0:I.productSn}),B=M(()=>p.value&&p.value.importExportStockList.length!==0?[...p.value.importExportStockList,{isLast:!0}]:void 0),F=M(()=>[{name:"receiptType",label:m("receipt_type"),field:o=>o.receiptType},{name:"dateTime",label:m("receipt_date_time"),field:o=>o.receiptDate},{name:"receiptSn",label:m("receipt_ID"),field:o=>o.receiptId},{name:"importQuantity",label:m("import_quantity"),field:o=>o.importQuantity},{name:"importPrice",label:m("import_price"),field:o=>o.importPrice},{name:"exportQuantity",label:m("export_quantity"),field:o=>o.exportQuantity},{name:"exportPrice",label:m("export_price"),field:o=>o.exportPrice},{name:"note",label:m("note"),field:o=>o.note}]),S=()=>b.replace({path:"/settings/stock/inventory",query:C({},e.query)});return(o,d)=>(w(),D(P,null,[r(Z,{"model-value":!0,onHide:S},{default:n(()=>[r(tt,{style:{width:"1360px","max-width":"80vw"}},{default:n(()=>[r(q,{class:"row items-center"},{default:n(()=>[y("div",xt,c(a(m)("import_export_detail")),1),r(G),et(r(L,{icon:"close",flat:"",round:"",dense:""},null,512),[[nt]])]),_:1}),r(q,{class:"q-pt-none"},{default:n(()=>[y("div",kt,[y("span",null,c(a(b).options.history.state.productName),1),y("span",null,c(a(m)("unit"))+": "+c(a(b).options.history.state.productUnitName),1),s.value&&_.value?(w(),D("div",wt,[y("span",null,c(a(m)("from"))+" "+c(s.value)+" "+c(a(m)("to"))+" "+c(_.value),1)])):at("v-if",!0)]),r(lt,{loading:a(O),columns:a(F),rows:a(B),"rows-per-page-options":[0],"hide-pagination":"","hide-bottom":"","no-data-label":"No data",flat:""},{header:n(t=>[r(V,null,{default:n(()=>[(w(!0),D(P,null,ot(t.cols,l=>(w(),it(st,{key:l.name,props:t,class:"th"},{default:n(()=>[f(c(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1024)]),body:n(t=>[r(V,{props:t,class:rt(t.row.isLast?"bg-white text-weight-bolder":""),"no-hover":""},{default:n(()=>[r(u,{key:"receiptType",props:t,class:"td"},{default:n(()=>[f(c(t.row.isLast?a(m)("total"):t.row.receiptType===1?a(m)("import_stock"):t.row.receiptType===2?a(m)("export_stock"):""),1)]),_:2},1032,["props"]),r(u,{key:"dateTime",props:t,class:"td"},{default:n(()=>[f(c(a(x).formatDate(t.row.receiptDate*1e3,a(ut))),1)]),_:2},1032,["props"]),r(u,{key:"receiptSn",props:t,class:"td"},{default:n(()=>[r(L,{label:t.row.receiptId,flat:"",dense:"",color:"orange-10",onClick:l=>Y(t.row.receiptType,t.row.stockSn)},null,8,["label","onClick"])]),_:2},1032,["props"]),r(u,{key:"importQuantity",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?(l=a(p))==null?void 0:l.total.importQuantity:t.row.importQuantity),1)]}),_:2},1032,["props"]),r(u,{key:"importPrice",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?a(T)((l=a(p))==null?void 0:l.total.importPrice):a(T)(t.row.importPrice))+" VND ",1)]}),_:2},1032,["props"]),r(u,{key:"exportQuantity",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?(l=a(p))==null?void 0:l.total.exportQuantity:t.row.exportQuantity),1)]}),_:2},1032,["props"]),r(u,{key:"exportPrice",props:t,class:"td"},{default:n(()=>{var l;return[f(c(t.row.isLast?a(T)((l=a(p))==null?void 0:l.total.exportPrice):a(T)(t.row.exportPrice))+" VND ",1)]}),_:2},1032,["props"]),r(u,{key:"note",props:t,class:"td"},{default:n(()=>[y("p",Tt,c(t.row.note),1)]),_:2},1032,["props"])]),_:2},1032,["props","class"])]),_:1},8,["loading","columns","rows"])]),_:1})]),_:1})]),_:1}),r(mt,{ref_key:"exportDetailModal",ref:h},null,512),r(ft,{ref_key:"importStockEditModal",ref:g,modelValue:k.value,"onUpdate:modelValue":d[0]||(d[0]=t=>k.value=t),onClose:$},null,8,["modelValue"])],64))}});var te=K(bt,[["__scopeId","data-v-d4130e6e"],["__file","D:/gopms-web/src/modules/stock/inventory/pages/detail.vue"]]);export{te as default};
