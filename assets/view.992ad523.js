import{Q as q,a as D,b as B}from"./QScrollArea.76ce0d19.js";import{Q as F,a as L}from"./selection.6afffe69.js";import{Q as U}from"./QList.e5651779.js";import{aw as w,bh as k,_ as ie,r as m,C as oe,a as z,w as ne,K as le,F as i,L as g,M as a,at as ce,I as o,R as d,U as _,N as s,G as u,V as K,W as M,Q as T,O as h,bo as re,az as N,bz as v,aD as R,aI as pe,q as de,aG as ue}from"./index.7efcbe86.js";import{Q as ye}from"./QInnerLoading.5fef3982.js";import{C as me}from"./ClosePopup.145acd40.js";import{u as _e}from"./useI18n.6b7b36de.js";import{f as fe}from"./useFormat.349e799c.js";import{u as he}from"./useReceiptTypeQuery.2e6198bb.js";import{b as x,u as ve}from"./axiosClient.a0ee23b9.js";import{Q as E}from"./queryKeys.832af9fa.js";import{u as Re}from"./useNotify.967ca7e7.js";import"./QResizeObserver.315a2c46.js";import"./QScrollObserver.614f31ec.js";import"./TouchPan.87d2034a.js";import"./touch.70a9dd44.js";import"./use-quasar.f3f15168.js";const ge=async n=>{const{data:l}=await x.post("/configuration/cashiering/createReceiptType",n);return l.data},Te=()=>{const n=k();return w(ge,{onSuccess:()=>{n.invalidateQueries(E.RECEIPT_TYPES)}})},be=async n=>{const{data:l}=await x.post("/configuration/cashiering/updateReceiptType",n);return l.data},Ce=()=>{const n=k();return w(be,{onSuccess:()=>{n.invalidateQueries(E.RECEIPT_TYPES)}})},Se=async n=>{const{data:l}=await x.post("/configuration/cashiering/deleteReceiptType",n);return l.data},we=()=>{const n=k();return w(Se,{onSuccess:()=>{n.invalidateQueries(E.RECEIPT_TYPES)}})};const ke={setup(){const{t:n}=_e(),{notifyUpdateSuccess:l,notifySaveSuccess:C}=Re(),{hasPermission:e}=ve(),I=m(!0),b=m(1),c=oe({isShowInputCreateReceiptTypes:!1,openDialogRemoveReceiptTypes:!1,isSubmitCreateReceiptType:!1}),t=m(),p=m(""),y=m(),Y=m([{key:"cashiering_cash_receipt",value:1},{key:"cashiering_cash_payment",value:2}]),O=r=>{b.value=r,c.isShowInputCreateReceiptTypes=!1},{data:j,isLoading:A,refetch:G}=he(),{mutate:W}=Te(),{mutate:H}=Ce(),{mutate:J}=we(),f=m({name:""}),X=m(null),Q=z(()=>{var r,V;return!!((r=f.value)!=null&&r.name)&&((V=f.value)==null?void 0:V.name.length)<=50}),Z=m(null),P=z(()=>!!p.value&&p.value.length<=50),$=()=>{S(),c.isShowInputCreateReceiptTypes=!0},ee=()=>{t.value=0},te=()=>{S(),c.isShowInputCreateReceiptTypes=!1},ae=()=>{if(c.isSubmitCreateReceiptType=!0,c.isShowInputCreateReceiptTypes=!0,f.value.name=="")se();else if(Q.value)c.isShowInputCreateReceiptTypes=!1,W({cashieringCategorySn:b.value,name:f.value.name},{onSuccess:()=>{C(),S()}});else return!1};ne(()=>ce.global.locale.value,()=>{G.value()});const S=()=>{f.value.name=""},se=()=>{c.isSubmitCreateReceiptType=!1,c.isShowInputCreateReceiptTypes=!1};return{t:n,formatMoney:fe,visible:I,formValues:f,isShowInputEditReceiptTypes:t,categoryOptions:Y,categorySn:b,data:j,isLoading:A,nameReceiptType:p,ui:c,hasPermission:e,receiptTypeCreateField:X,isReceiptTypeCreateRules:Q,receiptTypeEditField:Z,isReceiptTypeEditRules:P,onChangeProducts:O,onCancelSubmitCreateReceiptTypes:te,openInputNewReceiptTypes:$,onRemoveReceiptTypes:r=>{c.openDialogRemoveReceiptTypes=!0,y.value=r},onEditReceiptTypes:r=>{t.value=r.sn,p.value=r.name},onSubmitEditReceiptTypes:r=>{if(r.name==p.value)return t.value=!1,!1;if(P.value)H({sn:r.sn,name:p.value},{onSuccess:()=>{l(),t.value=!1}});else return!1},onCancelSubmitEditReceiptTypes:ee,onSubmitCreateReceiptTypes:ae,onConfirmRemoveReceiptTypePopup:()=>{J({sn:y.value},{onSuccess:()=>{C(),c.openDialogRemoveReceiptTypes=!1}})},thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"grey",width:"5px",opacity:"0.75"},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"grey",width:"9px",opacity:" 0.2"}}}},xe={class:"row q-mb-md"},Ee={class:"text-h5 text-bold"},Ie={class:"row q-col-gutter-lg"},Qe={class:"col-12 col-md-3"},Pe={class:"col-12 col-md-9"},Ve={lass:"full-width","full-height":"",class:"q-mt-md row justify-center"},qe={class:"caption"},De={key:0,class:"text-left"},Be={key:0},Fe={key:0,class:"text-left"},Le={key:1,class:"text-left"},Ue={class:"row justify-between items-center"},ze={class:"q-md-2"},Ke={key:0,class:"text-grey-8 q-gutter-xs"},Me={key:1,"full-height":"",class:"q-mt-md row justify-center full-width"},Ne={align:"center"},Ye={class:"text-bold"},Oe={align:"right",class:"q-gutter-sm"};function je(n,l,C,e,I,b){const c=le("pms-sections");return i(),g(c,null,{header:a(()=>[o("div",xe,[o("div",Ee,d(e.t("cashiering")),1)])]),default:a(()=>[o("div",Ie,[_(" Categories "),o("div",Qe,[s(q,{"inline-actions":"",rounded:"",class:"bg-negative text-white"},{default:a(()=>[o("b",null,d(e.t("categories")),1)]),_:1}),s(B,{visible:e.visible,style:{height:"100px"},"thumb-style":e.thumbStyle,"bar-style":e.barStyle},{default:a(()=>[s(D,{offset:50},{default:a(()=>[(i(!0),u(M,null,K(e.categoryOptions,(t,p)=>(i(),u("div",{key:p,class:"caption bg-white"},[s(U,{padding:""},{default:a(()=>[s(F,{clickable:"",class:h(e.categoryOptions[0].value==t.value&&e.categorySn==1?"active-link":""),active:e.categorySn===t.value,"active-class":"active-link",onClick:y=>e.onChangeProducts(t.value)},{default:a(()=>[s(L,null,{default:a(()=>[o("strong",null,d(e.t(t.key)),1)]),_:2},1024)]),_:2},1032,["class","active","onClick"])]),_:2},1024)]))),128))]),_:1})]),_:1},8,["visible","thumb-style","bar-style"])]),_(" Products "),o("div",Pe,[s(q,{"inline-actions":"",rounded:"",class:"bg-negative text-white"},{action:a(()=>[s(T,{push:"",color:"white","text-color":"negative",label:e.t("receipt_type"),icon:"add",dense:"",class:h(e.hasPermission("add-edit-delete-receipt-types")===!1?"hidden":""),"no-caps":"",onClick:e.openInputNewReceiptTypes},null,8,["label","class","onClick"])]),default:a(()=>[o("b",null,d(e.t("receipt_types")),1)]),_:1}),s(B,{visible:e.visible,style:{height:"600px"},"thumb-style":e.thumbStyle,"bar-style":e.barStyle},{default:a(()=>[s(ye,{showing:e.isLoading,label:"Please","label-class":"text-teal","label-style":"font-size:1.1em"},{default:a(()=>[o("div",Ve,[s(re,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"]),o("div",qe,[e.ui.isShowInputCreateReceiptTypes?(i(),g(N,{key:0,ref:"receiptTypeCreateField",modelValue:e.formValues.name,"onUpdate:modelValue":l[0]||(l[0]=t=>e.formValues.name=t),class:h([e.hasPermission("add-edit-delete-receipt-types")===!1?"hidden":"","full-width q-py-sm q-px-md"]),borderless:"",autofocus:"",dense:"",error:!e.isReceiptTypeCreateRules&&e.formValues.name!="",placeholder:e.t("input_receipt_type_name"),onBlur:e.onSubmitCreateReceiptTypes,onKeydown:[v(R(e.onSubmitCreateReceiptTypes,["prevent"]),["enter"]),v(R(e.onCancelSubmitCreateReceiptTypes,["prevent"]),["esc"]),v(R(e.onCancelSubmitCreateReceiptTypes,["prevent"]),["tab"])]},{error:a(()=>[e.formValues.name.length>50?(i(),u("p",De,d(e.t("the_length_is_from_1_to_50_characters")),1)):_("v-if",!0)]),_:1},8,["modelValue","class","error","placeholder","onBlur","onKeydown"])):_("v-if",!0)]),e.data?(i(),g(D,{key:0,offset:50},{default:a(()=>[(e.categorySn==1?e.data[0].receiptTypeList.length>0:e.data[1].receiptTypeList.length>0)?(i(),u("div",Be,[(i(!0),u(M,null,K(e.categorySn==1?e.data[0].receiptTypeList:e.data[1].receiptTypeList,(t,p)=>(i(),u("div",{key:p,class:"caption bg-white text-bold"},[s(U,null,{default:a(()=>[s(F,null,{default:a(()=>[e.isShowInputEditReceiptTypes==t.sn?(i(),g(N,{key:0,ref_for:!0,ref:"receiptTypeEditField",modelValue:e.nameReceiptType,"onUpdate:modelValue":l[1]||(l[1]=y=>e.nameReceiptType=y),class:h([e.hasPermission("add-edit-delete-receipt-types")===!1?"hidden":"","full-width"]),borderless:"",autofocus:"",dense:"",error:!e.isReceiptTypeEditRules,placeholder:e.t("input_receipt_type_name"),onBlur:y=>e.onSubmitEditReceiptTypes(t),onKeydown:[v(R(y=>e.onSubmitEditReceiptTypes(t),["prevent"]),["enter"]),v(R(e.onCancelSubmitEditReceiptTypes,["prevent"]),["esc"]),v(R(e.onCancelSubmitEditReceiptTypes,["prevent"]),["tab"])]},{error:a(()=>[e.nameReceiptType?e.nameReceiptType.length>50?(i(),u("p",Le,d(e.t("the_length_is_from_1_to_50_characters")),1)):_("v-if",!0):(i(),u("p",Fe,d(e.t("this_field_is_required")),1))]),_:2},1032,["modelValue","class","error","placeholder","onBlur","onKeydown"])):(i(),g(L,{key:1},{default:a(()=>[o("div",Ue,[o("div",ze,d(t.name),1),t.sn!=1&&t.sn!=2&&t.sn!=3?(i(),u("div",Ke,[s(T,{class:h(["gt-xs",e.hasPermission("add-edit-delete-receipt-types")===!1?"hidden":""]),size:"12px",flat:"",dense:"",round:"",icon:"edit",onClick:y=>e.onEditReceiptTypes(t)},null,8,["class","onClick"]),s(T,{class:h(["gt-xs",e.hasPermission("add-edit-delete-receipt-types")===!1?"hidden":""]),size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:y=>e.onRemoveReceiptTypes(t.sn)},null,8,["class","onClick"])])):_("v-if",!0)])]),_:2},1024))]),_:2},1024)]),_:2},1024)]))),128))])):(i(),u("div",Me,d(e.t("no_data")),1))]),_:1})):_("v-if",!0)]),_:1},8,["visible","thumb-style","bar-style"])])]),s(pe,{modelValue:e.ui.openDialogRemoveReceiptTypes,"onUpdate:modelValue":l[2]||(l[2]=t=>e.ui.openDialogRemoveReceiptTypes=t)},{default:a(()=>[s(ue,{class:"q-pa-lg"},{default:a(()=>[o("div",Ne,[o("p",Ye,d(e.t("are_you_sure_you_want_to_delete_this_receipt_type")),1)]),o("div",Oe,[de(s(T,{label:e.t("cancel"),class:"q-px-sm",dense:"",outline:"","no-caps":"",color:"grey-8"},null,8,["label"]),[[me]]),s(T,{label:e.t("confirm"),color:"negative",style:{width:"100px"},dense:"","no-caps":"",onClick:e.onConfirmRemoveReceiptTypePopup},null,8,["label","onClick"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var yt=ie(ke,[["render",je],["__scopeId","data-v-5a4dfcb8"],["__file","D:/gopms-web/src/modules/cashiering/view.vue"]]);export{yt as default};
