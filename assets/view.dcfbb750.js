import{_ as De,J as Re,r as Ie,bx as Qe,K as le,F as f,G as xe,N as t,P as e,M as s,W as Ne,I as d,R as c,Q as ne,U as g,L as k,q as S,O as _,aF as b,am as T,aH as $,bo as Oe}from"./index.7efcbe86.js";import{Q as y,a as h}from"./selection.6afffe69.js";import{Q as $e}from"./QList.e5651779.js";import{Q as Te}from"./QMenu.b19dfcca.js";import{Q as U,a as q,b as B}from"./QTabPanels.ffcab7b1.js";import{Q as Ue}from"./QTabs.85589f95.js";import{Q as qe}from"./QInnerLoading.5fef3982.js";import{C as V}from"./ClosePopup.145acd40.js";import{s as ie,I as Be,S as Pe,P as je}from"./useBookingStatus.37cf751f.js";import{u as Fe,a as ze,b as Me,C as Ee,c as Le,d as Ae,e as Ge}from"./useCheckInMutation.b014659e.js";import{u as He}from"./axiosClient.a0ee23b9.js";import{u as Je}from"./useI18n.6b7b36de.js";import{u as Ke}from"./use-quasar.f3f15168.js";import{u as We}from"./useNotify.967ca7e7.js";import"./position-engine.4a23d733.js";import"./touch.70a9dd44.js";import"./use-cache.b0833c75.js";import"./QResizeObserver.315a2c46.js";import"./rtl.4b414a6d.js";import"./QSelect.8edab530.js";import"./QItemLabel.938a9258.js";import"./QForm.df816fa6.js";import"./useCalculateBookingAmountMutation.46b5c200.js";import"./queryKeys.832af9fa.js";import"./useFormat.349e799c.js";import"./QDate.804040fd.js";import"./QPopupProxy.9996c4ad.js";import"./date.2d51ed98.js";import"./useAppendixQuery.039c05de.js";import"./QSpace.c00d4884.js";import"./QBar.49f2f7c7.js";import"./useValidate.96008b94.js";import"./QTable.4cc8e1c9.js";import"./QTooltip.c975c2a0.js";import"./QToolbarTitle.6428114f.js";import"./QToolbar.1dcdb2c5.js";import"./const.327e9cc0.js";import"./QTime.fadff47c.js";import"./TouchPan.87d2034a.js";import"./useCreateDate.6141d343.js";const Xe={class:"row justify-between items-center",style:{height:"100%"}},Ye={class:"text-bold",style:{"font-size":"20px"}},Ze={class:"row items-center"},eo={style:{"font-size":"20px"}},oo={class:"text-bold"},ao={class:"row justify-center q-mb-md"},to={class:"flex justify-end text-body1 q-mt-md text-grey-6"},so={lass:"full-width full-height q-mt-md row justify-center"},lo=Re({setup(no){let l=Ie();const P=Qe();P.params.tab?l.value=P.params.tab:l.value="roomInformation";const{notifyUpdateSuccess:re}=We(),me=Fe(),ue=Ke(),{t:i}=Je(),{hasPermission:v}=He(),ce=p=>{ue.dialog({message:i("check_in_room_view"),cancel:{color:"grey-8",label:i("cancel"),noCaps:!0,dense:!0,outline:!0},color:"negative",ok:{color:"negative",label:i("confirm"),noCaps:!0,dense:!0}}).onOk(()=>{me.mutate({bookingSn:p?String(p):""},{onSuccess:a=>{a&&(re(),j.value())}})})},{isDisplayEarlyCheckIn:de,formPayment:fe,formRoomInfo:o,serviceInfo:pe,refetchBookingDetails:j,bookingDetailsFetching:ge}=ze(),{ui:u,cancelReservationDialogRef:ke,changeStayDateDialogRef:be,changeRoomDialogRef:ve,checkOutDialogRef:Se,openChangeStayDate:_e,openCancelReservationDialog:ye,openChangeRoomDialog:he,openCheckOutDialog:Ve}=Me(),O=p=>{switch(j.value(),p){case"cancelReservation":u.cancelReservationVisible=!1;break;case"changeStayDate":u.changeStayDateVisible=!1;break;case"changeRoom":u.changeRoomVisible=!1;break;case"checkOut":u.checkOutDialogVisible=!1;break}};return(p,a)=>{const we=le("router-link"),Ce=le("pms-sections");return f(),xe(Ne,null,[t(Ee,{ref_key:"changeRoomDialogRef",ref:ve,modelValue:e(u).changeRoomVisible,"onUpdate:modelValue":a[0]||(a[0]=r=>e(u).changeRoomVisible=r),onChangeSuccess:a[1]||(a[1]=r=>O("changeRoom"))},null,8,["modelValue"]),t(Le,{ref_key:"cancelReservationDialogRef",ref:ke,modelValue:e(u).cancelReservationVisible,"onUpdate:modelValue":a[2]||(a[2]=r=>e(u).cancelReservationVisible=r),onCancelSuccess:a[3]||(a[3]=r=>O("cancelReservation"))},null,8,["modelValue"]),t(Ae,{ref_key:"checkOutDialogRef",ref:Se,modelValue:e(u).checkOutDialogVisible,"onUpdate:modelValue":a[4]||(a[4]=r=>e(u).checkOutDialogVisible=r),onCheckOutSuccess:a[5]||(a[5]=r=>O("checkOut"))},null,8,["modelValue"]),t(Ge,{ref_key:"changeStayDateDialogRef",ref:be,modelValue:e(u).changeStayDateVisible,"onUpdate:modelValue":a[6]||(a[6]=r=>e(u).changeStayDateVisible=r),onChangeSuccess:a[7]||(a[7]=r=>O("changeStayDate"))},null,8,["modelValue"]),t(Ce,{title:e(i)("booking_detail"),class:"relative-position",style:{"min-height":"calc(100vh - 265px)"}},{default:s(()=>{var r,F,z,M,E,L;return[d("div",Xe,[d("p",Ye,c((r=e(o))==null?void 0:r.roomTypeCode)+" - "+c((F=e(o))==null?void 0:F.roomName),1),d("div",Ze,[d("p",eo,"#"+c((z=e(o))==null?void 0:z.bookingNo),1),t(ne,{class:"q-mx-lg","no-caps":"",unelevated:"",color:(E=e(ie)((M=e(o))==null?void 0:M.bookingStatusSn))==null?void 0:E.color},{default:s(()=>{var n,w;return[d("p",oo,c((w=e(ie)((n=e(o))==null?void 0:n.bookingStatusSn))==null?void 0:w.typeName),1)]}),_:1},8,["color"]),g(` <q-btn
          v-if="formRoomInfo?.bookingStatusSn !== 3 && formRoomInfo?.bookingStatusSn !== 6"
          class="bg-grey-1"
          icon="more_vert"
          flat
        > `),((L=e(o))==null?void 0:L.bookingStatusSn)!==3?(f(),k(ne,{key:0,class:"bg-grey-1",icon:"more_vert",flat:""},{default:s(()=>[t(Te,{"transition-show":"jump-down","transition-hide":"jump-up"},{default:s(()=>[t($e,{style:{"min-width":"200px"}},{default:s(()=>{var n,w,A,G,H,J,K,W,X,Y,Z,ee,oe,ae,te;return[S((f(),k(y,{class:_(e(v)("edit-booking-detail")==!1?"hidden":""),clickable:""},{default:s(()=>[t(h,{class:"row",onClick:a[8]||(a[8]=C=>p.$router.push({name:"BookingEdit",params:{sn:p.$route.params.sn}}))},{default:s(()=>[b(c(e(i)("edit_booking")),1)]),_:1})]),_:1},8,["class"])),[[V]]),t(T),((n=e(o))==null?void 0:n.bookingStatusSn)===2||((w=e(o))==null?void 0:w.bookingStatusSn)===5?S((f(),k(y,{key:0,class:_(e(v)("check-out")==!1?"hidden":""),clickable:"",onClick:a[9]||(a[9]=C=>{var m;return e(Ve)((m=e(o))==null?void 0:m.sn)})},{default:s(()=>[t(h,{class:"row"},{default:s(()=>[b(c(e(i)("check_out")),1)]),_:1})]),_:1},8,["class"])),[[V]]):g("v-if",!0),((A=e(o))==null?void 0:A.bookingStatusSn)===4||((G=e(o))==null?void 0:G.bookingStatusSn)===1?S((f(),k(y,{key:1,class:_(e(v)("check-in")==!1?"hidden":""),clickable:"",onClick:a[10]||(a[10]=C=>{var m;return ce((m=e(o))==null?void 0:m.sn)})},{default:s(()=>[t(h,{class:"row"},{default:s(()=>[b(c(e(i)("check_in")),1)]),_:1})]),_:1},8,["class"])),[[V]]):g("v-if",!0),((H=e(o))==null?void 0:H.bookingStatusSn)===1||((J=e(o))==null?void 0:J.bookingStatusSn)===4||((K=e(o))==null?void 0:K.bookingStatusSn)===2||((W=e(o))==null?void 0:W.bookingStatusSn)===5||((X=e(o))==null?void 0:X.bookingStatusSn)===6?S((f(),k(y,{key:2,class:_(e(v)("change-stay-date")==!1?"hidden":""),clickable:"",onClick:a[11]||(a[11]=C=>{var m,D,R,I,Q,x,N,se;return e(_e)((m=e(o))==null?void 0:m.sn,`${(D=e(o))==null?void 0:D.roomTypeCode} - ${(R=e(o))==null?void 0:R.roomName}`,(Q=(I=e(o))==null?void 0:I.guest[0])==null?void 0:Q.fullName,Number((x=e(o))==null?void 0:x.checkIn),Number((N=e(o))==null?void 0:N.checkOut),(se=e(o))==null?void 0:se.roomStatusSn)})},{default:s(()=>[t(h,{class:"row"},{default:s(()=>[b(c(e(i)("change_stay_date")),1)]),_:1})]),_:1},8,["class"])),[[V]]):g("v-if",!0),((Y=e(o))==null?void 0:Y.bookingStatusSn)===1||((Z=e(o))==null?void 0:Z.bookingStatusSn)===4||((ee=e(o))==null?void 0:ee.bookingStatusSn)===2||((oe=e(o))==null?void 0:oe.bookingStatusSn)===5?S((f(),k(y,{key:3,clickable:"",class:_(e(v)("change-room")==!1?"hidden":""),onClick:a[12]||(a[12]=C=>{var m,D,R,I,Q,x,N;return e(he)((m=e(o))==null?void 0:m.roomSn,`${(D=e(o))==null?void 0:D.roomTypeCode} - ${(R=e(o))==null?void 0:R.roomName}`,(Q=(I=e(o))==null?void 0:I.guest[0])==null?void 0:Q.fullName,(x=e(o))==null?void 0:x.sn,(N=e(o))==null?void 0:N.roomTypeSn)})},{default:s(()=>[t(h,{class:"row"},{default:s(()=>[b(c(e(i)("change_room")),1)]),_:1})]),_:1},8,["class"])),[[V]]):g("v-if",!0),t(T),((ae=e(o))==null?void 0:ae.bookingStatusSn)===1||((te=e(o))==null?void 0:te.bookingStatusSn)===4?S((f(),k(y,{key:4,class:_(e(v)("cancel-booking")==!1?"hidden":""),clickable:"",onClick:a[13]||(a[13]=C=>{var m;return e(ye)((m=e(o))==null?void 0:m.sn)})},{default:s(()=>[t(h,{class:"row"},{default:s(()=>[b(c(e(i)("cancel_booking")),1)]),_:1})]),_:1},8,["class"])),[[V]]):g("v-if",!0)]}),_:1})]),_:1})]),_:1})):g("v-if",!0)])]),t(T,{class:"q-my-md"}),d("div",ao,[t(Ue,{modelValue:e(l),"onUpdate:modelValue":a[14]||(a[14]=n=>$(l)?l.value=n:l=n),dense:"","active-color":"white",align:"justify","indicator-color":"transparent",class:"box-shadow-tabs col-lg-5 col-md-8 col-xs-12 row","active-bg-color":"negative"},{default:s(()=>[t(U,{name:"roomInformation",class:"col custom-tab",label:e(i)("room_information"),"no-caps":""},null,8,["label"]),t(U,{name:"services",class:"col custom-tab",label:e(i)("services"),"no-caps":""},null,8,["label"]),t(U,{name:"payment",class:"col custom-tab",label:e(i)("payment"),"no-caps":""},null,8,["label"])]),_:1},8,["modelValue"])]),d("div",null,[t(B,{modelValue:e(l),"onUpdate:modelValue":a[15]||(a[15]=n=>$(l)?l.value=n:l=n),class:"overflow-auto"},{default:s(()=>[t(q,{name:"roomInformation"},{default:s(()=>[t(Be,{data:e(o),page:"details"},null,8,["data"])]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:e(l),"onUpdate:modelValue":a[16]||(a[16]=n=>$(l)?l.value=n:l=n),class:"overflow-auto"},{default:s(()=>[t(q,{name:"services"},{default:s(()=>[t(Pe,{data:e(pe),"room-info":e(o),page:"services"},null,8,["data","room-info"])]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:e(l),"onUpdate:modelValue":a[17]||(a[17]=n=>$(l)?l.value=n:l=n),class:"overflow-auto"},{default:s(()=>[t(q,{name:"payment"},{default:s(()=>[t(je,{"form-room-info":e(o),data:e(fe),page:"details","is-display-early-check-in":e(de)},null,8,["form-room-info","data","is-display-early-check-in"])]),_:1})]),_:1},8,["modelValue"]),d("div",to,[t(we,{style:{"text-decoration":"none"},class:"custom-link",to:{name:"RoomView"}},{default:s(()=>[b(c(e(i)("back_to_room_view_mode")),1)]),_:1})])]),t(qe,{showing:e(ge)},{default:s(()=>[d("div",so,[t(Oe,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"])]}),_:1},8,["title"])],64)}}});var Jo=De(lo,[["__scopeId","data-v-ef5987c6"],["__file","D:/gopms-web/src/modules/booking/booking-details/view.vue"]]);export{Jo as default};
