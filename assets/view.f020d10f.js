import{Q as B}from"./QDate.804040fd.js";import{Q as E}from"./QPopupProxy.9996c4ad.js";import{av as U,_ as C,r as k,C as q,a as p,w as V,K as I,F as u,L as X,M as a,at as K,I as s,R as l,N as t,G as f,U as R,T as J,bo as L,aF as d}from"./index.7efcbe86.js";import{a as Y}from"./QMenu.b19dfcca.js";import{Q as F}from"./QSelect.8edab530.js";import{Q as j}from"./QInnerLoading.5fef3982.js";import{a as z,c as r,Q as G}from"./QTable.4cc8e1c9.js";import{Q as H}from"./QPagination.a48c1bef.js";import{u as W}from"./useI18n.6b7b36de.js";import{a as Z,f as $}from"./useFormat.349e799c.js";import{u as ee,a as oe}from"./useAppendixQuery.039c05de.js";import{B as te}from"./const.327e9cc0.js";import{b as ae,e as Q,d as ne,c as le}from"./axiosClient.a0ee23b9.js";import{Q as ie}from"./queryKeys.832af9fa.js";import{n as re}from"./useCreateDate.6141d343.js";import{d as _}from"./date.2d51ed98.js";import"./use-cache.b0833c75.js";import"./position-engine.4a23d733.js";import"./selection.6afffe69.js";import"./QItemLabel.938a9258.js";import"./rtl.4b414a6d.js";import"./QList.e5651779.js";const se=async({queryKey:y})=>{const[,i]=y;if((i==null?void 0:i.dateFrom)&&(i==null?void 0:i.dateTo)){const{data:g}=await ae.get("/report/getRevenueReportList",{params:i});return g.data}},de=(y,i)=>{const g=[ie.REVENUE_REPORT,y];return U(g,se,{enabled:i,select:o=>o})};const me={setup(){const{data:y,isFetching:i}=ee({enabled:!0}),g=k(Date.now()),{data:o,isFetching:S}=oe({enabled:!0}),c=q({page:1,limit:10,dateFrom:Number(_.formatDate(g.value,"X")),dateTo:Number(_.formatDate(g.value,"X")),bookingStatusSn:null,roomTypeSn:null,bookingSourceSn:null}),{t:n}=W(),{data:h,isFetching:m}=de(c,!0),b=k(null),e=k(0),w=()=>{b==null||b.value.show()},M=p({get:()=>({from:c.dateFrom?_.formatDate(new Date(c.dateFrom*1e3),Q):"",to:c.dateTo?_.formatDate(new Date(c.dateTo*1e3),Q):""}),set:v=>{e.value=0,v?(c.dateFrom=Number(_.formatDate(new Date(v.from),"X"))||Number(_.formatDate(new Date(v),"X")),c.dateTo=Number(_.formatDate(new Date(v.to),"X"))||Number(_.formatDate(new Date(v),"X"))):c.dateFrom=c.dateTo=null,x()}}),O=p(()=>[{name:"no",label:n("no"),align:"left",field:""},{name:"bookingNo",label:n("booking_no"),align:"left",field:"bookingNo"},{name:"bookingStatusSn",align:"left",label:n("booking_status"),field:"bookingStatusSn"},{name:"roomTypeName",align:"left",label:n("room_types"),field:"roomTypeName"},{name:"roomName",align:"left",label:n("rooms"),field:"roomName"},{name:"bookingSourceName",align:"left",label:n("booking_sources"),field:"bookingSourceName"},{name:"guestName",align:"left",label:n("guest_name"),field:"guestName"},{name:"checkIn",align:"left",label:n("arrival_date_time"),field:"checkIn"},{name:"checkOut",align:"left",label:n("departure_date_time"),field:"checkOut"},{name:"roomPrice",align:"right",label:n("room_price_revenue"),field:"roomPrice"},{name:"servicePrice",align:"right",label:n("services_price"),field:"servicePrice"},{name:"extraFee",align:"right",label:n("extra_fee"),field:"extraFee"},{name:"discount",align:"right",label:n("discount"),field:"discount"},{name:"totalRevenue",align:"right",label:n("total_revenue"),field:"totalRevenue"},{name:"cash",align:"right",label:n("cash"),field:"cash"},{name:"creditCard",align:"right",label:n("credit_card"),field:"creditCard"},{name:"bankTransfer",align:"right",label:n("bank_transfer"),field:"bankTransfer"},{name:"debt",align:"right",label:n("debt"),field:"debt"},{name:"note",align:"left",label:n("booking_note"),field:"note"},{name:"pricingPlanName",align:"left",label:n("pricing_plan_name_tb_header"),field:"pricingPlanName"},{name:"timeToStay",align:"left",label:n("time_to_stay"),field:"timeToStay"},{name:"createByName",align:"left",label:n("created_by"),field:"createByName"}]),x=()=>{c.page=1},N=k([]),T=k([]),D=k([]);V(i,()=>{P()}),V(S,()=>{A()}),D.value=[{typeName:n("all_booking_statuses"),bookingStatusSn:null},...te];const P=()=>{N.value.push({name:n("all_booking_sources"),sn:null},...JSON.parse(JSON.stringify(y.value)))},A=()=>{T.value.push({name:n("all_room_types"),sn:null},...JSON.parse(JSON.stringify(o.value)))};return V(()=>K.global.locale.value,()=>{N.value[0]={name:n("all_booking_sources"),sn:null},D.value[0]={typeName:n("all_booking_statuses"),bookingStatusSn:null},T.value[0]={name:n("all_room_types"),sn:null}}),{t:n,columns:O,data:h,isFetching:m,formatIndexTable:Z,dateRangeType:e,onOpenDatePopUp:w,qDateRef:b,dateRange:M,formValues:c,useBookingSourcesFetching:i,FORMAT_DATE_UI:ne,FORMAT_DATE_TIME_UI:le,isRoomTypeFetching:S,newDateStamp:re,date:_,formatMoney:$,onApply:x,arrayBookingSources:N,arrayRoomTypes:T,arrayBookingStatuses:D}}},ce={class:"row q-mb-md"},ue={class:"text-h5 text-bold"},_e={class:"row q-mb-md q-gutter-md"},fe={key:0,class:"self-center full-width no-outline",tabindex:"0"},ge={style:{"min-width":"16%"}},be={style:{"min-width":"16%"}},ye={style:{"min-width":"16%"}},ke={class:"relative-position"},ve={lass:"full-width","full-height":"",class:"q-mt-md row justify-center"},we={key:0},Se={key:0,class:"text-orange-11"},he={key:1,class:"text-green-11"},Ne={key:2,class:"text-grey-11"},Te={key:3,class:"text-deep-orange-11"},De={key:4,class:"text-amber-11"},Ve={key:5,class:"text-blue-11"},Re={class:"slice-tooltip"},Fe=["data-title"],xe={class:"slice-tooltip"},pe=["data-title"],Ie={class:"slice-tooltip"},Qe=["data-title"],Me={class:"slice-tooltip"},Oe=["data-title"],Pe={class:"slice-tooltip slice-tooltip-2-line-clamp"},Ae=["data-title"],Be={class:"q-mt-md row justify-end"};function Ee(y,i,g,o,S,c){const n=I("router-link"),h=I("pms-sections");return u(),X(h,null,{header:a(()=>[s("div",ce,[s("div",ue,l(o.t("revenue_report")),1)]),s("div",_e,[s("div",null,[t(Y,{placeholder:"Select date time",dense:"","stack-label":"",filled:"",onFocus:o.onOpenDatePopUp},{control:a(()=>[o.dateRange.from&&o.dateRange.to?(u(),f("div",fe,l(o.date.formatDate(o.dateRange.from,o.FORMAT_DATE_UI))+" - "+l(o.date.formatDate(o.dateRange.to,o.FORMAT_DATE_UI)),1)):R("v-if",!0)]),prepend:a(()=>[t(J,{name:"event",class:"no-pointer-events"},{default:a(()=>[t(E,{ref:"qDateRef","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(B,{modelValue:o.dateRange,"onUpdate:modelValue":i[0]||(i[0]=m=>o.dateRange=m),range:""},null,8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["onFocus"])]),s("div",ge,[t(F,{modelValue:o.formValues.bookingStatusSn,"onUpdate:modelValue":[i[1]||(i[1]=m=>o.formValues.bookingStatusSn=m),i[2]||(i[2]=m=>o.onApply())],options:o.arrayBookingStatuses,dense:"",filled:"","option-value":"bookingStatusSn","option-label":"typeName","map-options":"","emit-value":""},null,8,["modelValue","options"])]),s("div",be,[t(F,{modelValue:o.formValues.roomTypeSn,"onUpdate:modelValue":[i[3]||(i[3]=m=>o.formValues.roomTypeSn=m),i[4]||(i[4]=m=>o.onApply())],loading:o.isRoomTypeFetching,options:o.arrayRoomTypes,dense:"",filled:"","option-value":"sn","option-label":"name","map-options":"","emit-value":""},null,8,["modelValue","loading","options"])]),s("div",ye,[t(F,{modelValue:o.formValues.bookingSourceSn,"onUpdate:modelValue":[i[5]||(i[5]=m=>o.formValues.bookingSourceSn=m),i[6]||(i[6]=m=>o.onApply())],loading:o.useBookingSourcesFetching,filled:"",dense:"",options:o.arrayBookingSources,"option-value":"sn","option-label":"name","map-options":"","emit-value":""},null,8,["modelValue","loading","options"])])])]),default:a(()=>{var m,b;return[s("div",ke,[t(j,{showing:o.isFetching,label:"Please","label-class":"text-teal","label-style":"font-size:1.1em"},{default:a(()=>[s("div",ve,[t(L,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"]),o.isFetching?R("v-if",!0):(u(),f("div",we,[t(G,{"rows-per-page-options":[0],rows:(m=o.data)==null?void 0:m.revenueReportList,columns:o.columns,"hide-pagination":"","hide-bottom":"","row-key":"no"},{body:a(e=>[t(z,{props:e},{default:a(()=>[t(r,{key:"no",props:e},{default:a(()=>[d(l(o.formatIndexTable(o.formValues.page,e.rowIndex)),1)]),_:2},1032,["props"]),t(r,{key:"bookingNo",props:e},{default:a(()=>{var w;return[t(n,{style:{"text-decoration":"none"},class:"custom-link text-negative",to:{name:"BookingDetails",params:{sn:(w=e.row)==null?void 0:w.sn}}},{default:a(()=>[d(l(e.row.bookingNo),1)]),_:2},1032,["to"])]}),_:2},1032,["props"]),t(r,{key:"bookingStatusSn",props:e},{default:a(()=>[e.row.bookingStatusSn===1?(u(),f("div",Se,l(e.row.bookingStatusName),1)):e.row.bookingStatusSn===2?(u(),f("div",he,l(e.row.bookingStatusName),1)):e.row.bookingStatusSn===3?(u(),f("div",Ne,l(e.row.bookingStatusName),1)):e.row.bookingStatusSn===4?(u(),f("div",Te,l(e.row.bookingStatusName),1)):e.row.bookingStatusSn===5?(u(),f("div",De,l(e.row.bookingStatusName),1)):e.row.bookingStatusSn===6?(u(),f("div",Ve,l(e.row.bookingStatusName),1)):R("v-if",!0)]),_:2},1032,["props"]),t(r,{key:"roomTypeName",props:e,class:"unset-white-space"},{default:a(()=>[s("div",Re,[s("div",{"data-title":e.row.roomTypeName},l(e.row.roomTypeName),9,Fe)])]),_:2},1032,["props"]),t(r,{key:"roomName",props:e,class:"unset-white-space"},{default:a(()=>[s("div",xe,[s("div",{"data-title":e.row.roomName},l(e.row.roomName),9,pe)])]),_:2},1032,["props"]),t(r,{key:"bookingSourceName",props:e,class:"unset-white-space"},{default:a(()=>[s("div",Ie,[s("div",{"data-title":e.row.bookingSourceName},l(e.row.bookingSourceName),9,Qe)])]),_:2},1032,["props"]),t(r,{key:"guestName",props:e,class:"unset-white-space"},{default:a(()=>[s("div",Me,[s("div",{"data-title":e.row.guestName},l(e.row.guestName),9,Oe)])]),_:2},1032,["props"]),t(r,{key:"checkIn",props:e},{default:a(()=>[d(l(o.newDateStamp(e.row.checkIn,o.FORMAT_DATE_TIME_UI)),1)]),_:2},1032,["props"]),t(r,{key:"checkOut",props:e},{default:a(()=>[d(l(o.newDateStamp(e.row.checkOut,o.FORMAT_DATE_TIME_UI)),1)]),_:2},1032,["props"]),t(r,{key:"roomPrice",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.roomPrice))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"servicePrice",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.servicePrice))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"extraFee",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.extraFee))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"discount",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.discount))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"totalRevenue",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.totalRevenue))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"cash",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.cash))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"creditCard",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.creditCard))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"bankTransfer",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.bankTransfer))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"debt",props:e},{default:a(()=>[d(l(o.formatMoney(e.row.debt))+" VND ",1)]),_:2},1032,["props"]),t(r,{key:"note",props:e,class:"unset-white-space"},{default:a(()=>[s("div",Pe,[s("div",{"data-title":e.row.note},l(e.row.note),9,Ae)])]),_:2},1032,["props"]),t(r,{key:"timeToStay",props:e},{default:a(()=>[d(l(e.row.pricingPlanName),1)]),_:2},1032,["props"]),t(r,{key:"timeToStay",props:e},{default:a(()=>[d(l(e.row.timeToStay),1)]),_:2},1032,["props"]),t(r,{key:"createByName",props:e},{default:a(()=>[d(l(e.row.createByName),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),s("div",Be,[t(H,{modelValue:o.formValues.page,"onUpdate:modelValue":i[7]||(i[7]=e=>o.formValues.page=e),color:"negative",max:((b=o.data)==null?void 0:b.meta.lastPage)||1,"max-pages":5,"boundary-numbers":"","direction-links":"",push:""},null,8,["modelValue","max"])])]))])]}),_:1})}var ro=C(me,[["render",Ee],["__scopeId","data-v-157eac35"],["__file","D:/gopms-web/src/modules/report/revenue-report/view.vue"]]);export{ro as default};
