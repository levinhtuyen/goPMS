import{aE as ne,aF as z,bj as ee,_ as I,r as v,a as A,F as w,G as B,N as a,M as i,aH as le,I as o,R as d,aI as q,aJ as K,q as Y,Q as b,W as ae,bA as ie,K as N,L as T,O as M,bq as de,aO as D,U as E,aR as L,aP as O}from"./index.4bd8ab7e.js";import{Q as re}from"./QInnerLoading.36fa411b.js";import{a as me,c as x,Q as ue}from"./QTable.87be80e4.js";import{Q as j}from"./QTooltip.a00a2acf.js";import{Q as fe}from"./QPagination.952d6437.js";import{C as G}from"./ClosePopup.34597da2.js";import{u as H}from"./useI18n.96209f4d.js";import{b as U,u as ce}from"./axiosClient.ad61c203.js";import{Q as J}from"./queryKeys.832af9fa.js";import{u as W}from"./useNotify.6f32b3a1.js";import{Q}from"./QSelect.2521a28c.js";import{Q as oe}from"./QForm.8a0c543d.js";import{u as te}from"./use-quasar.fa06306f.js";import{u as se}from"./useValidate.94ac08ef.js";import{a as _e}from"./useFormat.349e799c.js";import"./QList.550b5ccf.js";import"./position-engine.e365a736.js";import"./selection.cdf30163.js";import"./QMenu.d60d439b.js";import"./QItemLabel.0748896a.js";import"./rtl.4b414a6d.js";const ve=async s=>{const{data:l}=await U.get(`/staff/getStaffList?limit=10&page=${s}`);return l.data},ge=s=>ne([J.STAFF,s],()=>ve(s.value)),pe=async s=>{const{data:l}=await U.post("/staff/updateStaffStatus",s);return l},be=()=>z(pe),he=async s=>{const{data:l}=await U.post("/staff/createStaff",s);return l},ye=()=>{const s=ee();return z(he,{onSuccess:l=>{(l==null?void 0:l.code)==1&&s.invalidateQueries(J.STAFF)}})},Ve={props:{openCreateStaffModal:{type:Boolean,default:!1}},emits:["reset"],setup(s,l){const{t:r}=H(),e=te(),f=v(),{mutate:g,isLoading:n}=ye(),S=A(()=>s.openCreateStaffModal),h=v({fullName:"",mobile:"",email:"",roleSn:2,status:1,gender:0}),c=[{key:r("hotel_owner"),value:1},{key:r("front_desk"),value:2}],y=[{key:r("select_gender"),value:0},{key:r("male"),value:1},{key:r("female"),value:2}],{isRequiredRules:t,isEmailRules:_,isLengthFrom1To100Rules:k,isPhoneRules:R,isLengthFrom1To50Rules:C}=se(),{notifyUpdateSuccess:F}=W();return{onSubmit:()=>{var p;(p=f.value)==null||p.validate().then(V=>{if(V)g(h.value,{onSuccess:m=>{(m==null?void 0:m.code)==1?(F(),setTimeout(()=>{l.emit("reset",!1)},400)):(m==null?void 0:m.code)==2&&e.notify({message:r("we_couldnt_save_your_changes_please_try_again"),position:"top",type:"negative",actions:[{color:"white"}]})}});else return!1})},openStaffModalComputed:S,t:r,isRequiredRules:t,isEmailRules:_,isLengthFrom1To100Rules:k,isPhoneRules:R,isLengthFrom1To50Rules:C,formValues:h,roleOptions:c,genderOptions:y,isLoading:n,staffFormRef:f}}},Se={class:"col-12 col-sm-6 col-md-6 q-px-sm"},xe={class:"text-bold q-ma-xs"},we={class:"col-12 col-sm-6 col-md-6 q-px-sm"},qe={class:"text-bold q-ma-xs"},ke={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Re={class:"text-bold q-ma-xs"},Ce={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Fe={class:"text-bold q-ma-xs"},Me={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Qe={class:"text-bold q-ma-xs"},Ue={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Pe={class:"text-bold q-ma-xs"},Ne={class:"col-12 col-md-12 row justify-end q-px-lg q-pb-md q-gutter-sm"};function Te(s,l,r,e,f,g){return w(),B(ae,null,[a(oe,{ref:"staffFormRef"},{default:i(()=>[a(le,{class:"row"},{default:i(()=>[o("div",Se,[o("p",xe,d(e.t("staff_name"))+"*",1),a(q,{modelValue:e.formValues.fullName,"onUpdate:modelValue":l[0]||(l[0]=n=>e.formValues.fullName=n),filled:"",dense:"",placeholder:e.t("input_name"),"lazy-rules":"",rules:[...e.isRequiredRules,...e.isLengthFrom1To50Rules]},null,8,["modelValue","placeholder","rules"])]),o("div",we,[o("p",qe,d(e.t("status")),1),a(K,{modelValue:e.formValues.status,"onUpdate:modelValue":l[1]||(l[1]=n=>e.formValues.status=n),"false-value":0,"true-value":1,color:"negative"},null,8,["modelValue"])]),o("div",ke,[o("p",Re,d(e.t("role"))+"*",1),a(Q,{modelValue:e.formValues.roleSn,"onUpdate:modelValue":l[2]||(l[2]=n=>e.formValues.roleSn=n),filled:"",dense:"","map-options":"",label:e.t("select_role"),"option-label":"key","option-value":"value",options:e.roleOptions,"emit-value":"",placeholder:e.t("role"),rules:e.isRequiredRules},null,8,["modelValue","label","options","placeholder","rules"])]),o("div",Ce,[o("p",Fe,d(e.t("email"))+"*",1),a(q,{modelValue:e.formValues.email,"onUpdate:modelValue":l[3]||(l[3]=n=>e.formValues.email=n),filled:"",type:"email",dense:"",placeholder:e.t("input_email"),"lazy-rules":"",rules:[...e.isRequiredRules,...e.isLengthFrom1To100Rules,...e.isEmailRules]},null,8,["modelValue","placeholder","rules"])]),o("div",Me,[o("p",Qe,d(e.t("phone_number")),1),a(q,{modelValue:e.formValues.mobile,"onUpdate:modelValue":l[4]||(l[4]=n=>e.formValues.mobile=n),mask:"############",filled:"",dense:"",placeholder:e.t("input_phone_number"),"lazy-rules":"",rules:e.isPhoneRules},null,8,["modelValue","placeholder","rules"])]),o("div",Ue,[o("p",Pe,d(e.t("gender")),1),a(Q,{modelValue:e.formValues.gender,"onUpdate:modelValue":l[5]||(l[5]=n=>e.formValues.gender=n),filled:"",dense:"",clearable:"","map-options":"",label:e.t("select_gender"),"option-label":"key","option-value":"value",options:e.genderOptions,"emit-value":""},null,8,["modelValue","label","options"])])]),_:1})]),_:1},512),o("div",Ne,[Y(a(b,{label:e.t("cancel"),dense:"",outline:"","no-caps":"",color:"grey-8",style:{padding:"8px 20px"}},null,8,["label"]),[[G]]),a(b,{label:e.t("save"),class:"q-px-lg",loading:e.isLoading,type:"submit",color:"negative","no-caps":"",onClick:e.onSubmit},null,8,["label","loading","onClick"])])],64)}var De=I(Ve,[["render",Te],["__file","D:/project_learn/goPMS/src/modules/staff/components/create-staff-modal.vue"]]);const Ee=async s=>{const{data:l}=await U.post("/staff/updateStaff",s);return l},Le=()=>{const s=ee();return z(Ee,{onSuccess:l=>{(l==null?void 0:l.code)==1&&s.invalidateQueries(J.STAFF)}})},Oe={props:{openEditStaffModal:{type:Boolean,default:!1},staffDetail:{type:Object,default:null}},emits:["reset"],setup(s,l){const{t:r}=H(),e=te(),f=v(),{notifyUpdateSuccess:g}=W(),{mutate:n,isLoading:S}=Le(),h=A(()=>s.openEditStaffModal),c=v({sn:null,fullName:"",mobile:"",email:"",roleSn:2,status:1,gender:0});ie(()=>{var p,V,m,u,X,Z,$;c.value={sn:(p=s.staffDetail.row)==null?void 0:p.sn,fullName:(V=s.staffDetail.row)==null?void 0:V.fullName,mobile:(m=s.staffDetail.row)==null?void 0:m.mobile,email:(u=s.staffDetail.row)==null?void 0:u.email,roleSn:(X=s.staffDetail.row)==null?void 0:X.roleSn,status:(Z=s.staffDetail.row)==null?void 0:Z.status,gender:($=s.staffDetail.row)==null?void 0:$.gender}});const y=[{key:r("hotel_owner"),value:1},{key:r("front_desk"),value:2}],t=[{key:r("select_gender"),value:0},{key:r("male"),value:1},{key:r("female"),value:2}],{isRequiredRules:_,isEmailRules:k,isLengthFrom1To100Rules:R,isPhoneRules:C,isLengthFrom1To50Rules:F}=se();return{onSubmit:()=>{var p;(p=f.value)==null||p.validate().then(V=>{if(V)n(c.value,{onSuccess:m=>{(m==null?void 0:m.code)==1?(g(),setTimeout(()=>{l.emit("reset",!1)},400)):(m==null?void 0:m.code)==2&&e.notify({message:r("we_couldnt_save_your_changes_please_try_again"),position:"top",type:"negative",actions:[{color:"white"}]})}});else return!1})},openStaffModalComputed:h,t:r,isRequiredRules:_,isEmailRules:k,isLengthFrom1To100Rules:R,isPhoneRules:C,isLengthFrom1To50Rules:F,formValues:c,roleOptions:y,genderOptions:t,isLoading:S,staffFormRef:f}}},je={class:"col-12 col-sm-6 col-md-6 q-px-sm"},ze={class:"text-bold q-ma-xs"},Ie={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Ae={class:"text-bold q-ma-xs"},Be={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Ke={class:"text-bold q-ma-xs"},Ye={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Ge={class:"text-bold q-ma-xs"},He={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Je={class:"text-bold q-ma-xs"},We={class:"col-12 col-sm-6 col-md-6 q-px-sm"},Xe={class:"text-bold q-ma-xs"},Ze={class:"col-12 col-md-12 row justify-end q-px-lg q-pb-md q-gutter-sm"};function $e(s,l,r,e,f,g){return w(),B(ae,null,[a(oe,{ref:"staffFormRef"},{default:i(()=>[a(le,{class:"row"},{default:i(()=>[o("div",je,[o("p",ze,d(e.t("staff_name"))+"*",1),a(q,{modelValue:e.formValues.fullName,"onUpdate:modelValue":l[0]||(l[0]=n=>e.formValues.fullName=n),filled:"",dense:"",placeholder:e.t("input_name"),"lazy-rules":"",rules:[...e.isRequiredRules,...e.isLengthFrom1To50Rules]},null,8,["modelValue","placeholder","rules"])]),o("div",Ie,[o("p",Ae,d(e.t("status")),1),a(K,{modelValue:e.formValues.status,"onUpdate:modelValue":l[1]||(l[1]=n=>e.formValues.status=n),"false-value":0,"true-value":1,color:"negative"},null,8,["modelValue"])]),o("div",Be,[o("p",Ke,d(e.t("role"))+"*",1),a(Q,{ref:"roleField",modelValue:e.formValues.roleSn,"onUpdate:modelValue":l[2]||(l[2]=n=>e.formValues.roleSn=n),filled:"",dense:"","map-options":"",label:e.t("select_role"),"option-label":"key","option-value":"value",options:e.roleOptions,"emit-value":"",rules:e.isRequiredRules},null,8,["modelValue","label","options","rules"])]),o("div",Ye,[o("p",Ge,d(e.t("email"))+"*",1),a(q,{ref:"emailField",modelValue:e.formValues.email,"onUpdate:modelValue":l[3]||(l[3]=n=>e.formValues.email=n),filled:"",type:"email",dense:"",placeholder:e.t("input_email"),"lazy-rules":"",rules:[...e.isRequiredRules,...e.isLengthFrom1To100Rules,...e.isEmailRules]},null,8,["modelValue","placeholder","rules"])]),o("div",He,[o("p",Je,d(e.t("phone_number")),1),a(q,{ref:"phoneField",modelValue:e.formValues.mobile,"onUpdate:modelValue":l[4]||(l[4]=n=>e.formValues.mobile=n),mask:"############",filled:"",dense:"",placeholder:e.t("input_phone_number"),"lazy-rules":"",rules:e.isPhoneRules},null,8,["modelValue","placeholder","rules"])]),o("div",We,[o("p",Xe,d(e.t("gender")),1),a(Q,{modelValue:e.formValues.gender,"onUpdate:modelValue":l[5]||(l[5]=n=>e.formValues.gender=n),filled:"",dense:"","map-options":"",label:e.t("select_gender"),clearable:"","option-label":"key","option-value":"value",options:e.genderOptions,"emit-value":""},null,8,["modelValue","label","options"])])]),_:1})]),_:1},512),o("div",Ze,[Y(a(b,{label:e.t("cancel"),dense:"",outline:"","no-caps":"",color:"grey-8",style:{padding:"8px 20px"}},null,8,["label"]),[[G]]),a(b,{label:e.t("save"),class:"q-px-lg",loading:e.isLoading,type:"submit",color:"negative","no-caps":"",onClick:e.onSubmit},null,8,["label","loading","onClick"])])],64)}var el=I(Oe,[["render",$e],["__file","D:/project_learn/goPMS/src/modules/staff/components/edit-staff-model.vue"]]);const ll={components:{CreateStaffModal:De,EditStaffModal:el},setup(){const{t:s}=H(),l=v(!1),r=v(1),e=v(!1),f=v(!1),g=v(!1),{data:n,isFetching:S}=ge(r),h=be(),{hasPermission:c}=ce(),y=A(()=>[{name:"no",required:!0,label:s("no"),align:"left"},{name:"fullName",required:!0,label:s("staff_name"),align:"left",field:u=>u.fullName,format:u=>`${u}`},{name:"mobile",align:"left",label:s("phone_number"),field:"mobile"},{name:"email",align:"left",label:s("email"),field:"email"},{name:"role",align:"left",label:s("role"),field:"role"},{name:"status",align:"left",label:s("status"),field:"status"},{name:"operations",label:"",field:"operations"}]),t=v({}),_=v(null),k=u=>{g.value=!0,t.value=u},R=()=>{f.value=!0},C=u=>{t.value=u,t.value.status===1?_.value=s("are_you_sure_you_want_to_deactivate_this_account"):_.value=s("are_you_sure_you_want_to_activate_this_account"),l.value=!0},F=()=>{t.value.status=t.value.status?0:1,l.value=!1,m(t)},P=u=>{f.value=u,g.value=u},{notifySaveSuccess:p,notifySaveFailed:V}=W(),m=async u=>{h.mutate({staffSn:u.value.sn,status:u.value.status},{onSuccess:()=>{p()},onError:()=>{u.value.status=u.value.status?0:1,V()}})};return{t:s,hasPermission:c,openDialogStatus:l,currentPage:r,editRow:k,openModalNewStaff:R,onChangeStatus:C,onConfirmStatusPopup:F,resetStaffModal:P,columns:y,status:e,data:n,isFetching:S,openCreateStaffModal:f,openEditStaffModal:g,staffDetail:t,titleActiveModal:_,formatIndexTable:_e}}},al={class:"row q-mb-md justify-between"},ol={class:"text-h5 text-bold"},tl={class:"q-gutter-sm"},sl={class:"relative-position"},nl={lass:"full-width","full-height":"",class:"q-mt-md row justify-center"},il={key:0},dl={class:"limit-text"},rl={class:"limit-text"},ml={class:"q-mt-md row justify-end"},ul={class:"text-h5 q-mt-lg q-mx-lg"},fl={class:"text-h5 q-mt-lg q-mx-lg"},cl={align:"center"},_l={class:"text-bold"},vl={align:"end",class:"q-gutter-sm"};function gl(s,l,r,e,f,g){const n=N("create-staff-modal"),S=N("edit-staff-modal"),h=N("pms-sections");return w(),T(h,null,{header:i(()=>[o("div",al,[o("div",ol,d(e.t("staff_list")),1),o("div",tl,[a(b,{color:"negative",icon:"add",label:e.t("new_staff"),class:M(e.hasPermission("add-edit-staff")==!1?"hidden":""),"no-caps":"",onClick:l[0]||(l[0]=c=>e.openModalNewStaff())},null,8,["label","class"]),a(b,{color:"negative",label:e.t("permission"),class:M(e.hasPermission("permission")==!1?"hidden":""),"no-caps":"",onClick:l[1]||(l[1]=c=>s.$router.push({name:"permission"}))},null,8,["label","class"])])])]),default:i(()=>{var c,y;return[o("div",sl,[a(re,{showing:e.isFetching,label:"Please","label-class":"text-teal","label-style":"font-size:1.1em"},{default:i(()=>[o("div",nl,[a(de,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"]),e.isFetching?E("v-if",!0):(w(),B("div",il,[a(ue,{"rows-per-page-options":[0],rows:(c=e.data)==null?void 0:c.staffList,columns:e.columns,"hide-pagination":"","hide-bottom":"","row-key":"no"},{body:i(t=>[a(me,{props:t},{default:i(()=>[a(x,{key:"no",props:t},{default:i(()=>[D(d(e.formatIndexTable(e.currentPage,t.rowIndex)),1)]),_:2},1032,["props"]),a(x,{key:"fullName",props:t},{default:i(()=>[o("div",dl,d(t.row.fullName),1),t.row.fullName.length>42?(w(),T(j,{key:0,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:i(()=>[o("strong",null,d(t.row.fullName),1)]),_:2},1024)):E("v-if",!0)]),_:2},1032,["props"]),a(x,{key:"mobile",props:t},{default:i(()=>[D(d(t.row.mobile),1)]),_:2},1032,["props"]),a(x,{key:"email",props:t},{default:i(()=>[o("div",rl,d(t.row.email),1),t.row.email.length>42?(w(),T(j,{key:0,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:i(()=>[o("strong",null,d(t.row.email),1)]),_:2},1024)):E("v-if",!0)]),_:2},1032,["props"]),a(x,{key:"role",props:t},{default:i(()=>[D(d(t.row.roleSn==1?e.t("hotel_owner"):e.t("front_desk")),1)]),_:2},1032,["props"]),a(x,{key:"status",props:t,class:M(e.hasPermission("activate-deactivate-staff")==!1?"hidden":"")},{default:i(()=>[a(K,{modelValue:t.row.status,"onUpdate:modelValue":_=>t.row.status=_,"false-value":0,"true-value":1,color:"negative",onClick:_=>e.onChangeStatus(t.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1032,["props","class"]),a(x,{key:"operations",props:t,class:M(e.hasPermission("add-edit-staff")==!1?"hidden":"")},{default:i(()=>[a(j,{class:"negative",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:i(()=>[o("strong",null,d(e.t("edit")),1)]),_:1}),a(b,{dense:"",round:"",flat:"",color:"grey-9",icon:"edit",onClick:_=>e.editRow(t)},null,8,["onClick"])]),_:2},1032,["props","class"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),o("div",ml,[a(fe,{modelValue:e.currentPage,"onUpdate:modelValue":l[2]||(l[2]=t=>e.currentPage=t),color:"negative",max:((y=e.data)==null?void 0:y.meta.lastPage)||1,"max-pages":5,"boundary-numbers":"","direction-links":"",push:""},null,8,["modelValue","max"])])]))]),a(L,{modelValue:e.openCreateStaffModal,"onUpdate:modelValue":l[3]||(l[3]=t=>e.openCreateStaffModal=t)},{default:i(()=>[a(O,{style:{width:"700px","max-width":"80vw"}},{default:i(()=>[o("div",ul,d(e.t("new_staff")),1),a(n,{onReset:e.resetStaffModal},null,8,["onReset"])]),_:1})]),_:1},8,["modelValue"]),a(L,{modelValue:e.openEditStaffModal,"onUpdate:modelValue":l[4]||(l[4]=t=>e.openEditStaffModal=t)},{default:i(()=>[a(O,{style:{width:"700px","max-width":"80vw"}},{default:i(()=>[o("div",fl,d(e.t("edit_staff")),1),a(S,{"staff-detail":e.staffDetail,onReset:e.resetStaffModal},null,8,["staff-detail","onReset"])]),_:1})]),_:1},8,["modelValue"]),a(L,{modelValue:e.openDialogStatus,"onUpdate:modelValue":l[5]||(l[5]=t=>e.openDialogStatus=t)},{default:i(()=>[a(O,{class:"q-pa-lg"},{default:i(()=>[o("div",cl,[o("p",_l,d(e.titleActiveModal),1)]),o("div",vl,[Y(a(b,{label:e.t("cancel"),dense:"",outline:"","no-caps":"",color:"grey-8",style:{padding:"6px 16px"}},null,8,["label"]),[[G]]),a(b,{label:e.t("confirm"),color:"negative",style:{width:"100px"},"no-caps":"",onClick:e.onConfirmStatusPopup},null,8,["label","onClick"])])]),_:1})]),_:1},8,["modelValue"])]}),_:1})}var Ll=I(ll,[["render",gl],["__scopeId","data-v-1e2e5195"],["__file","D:/project_learn/goPMS/src/modules/staff/view.vue"]]);export{Ll as default};
