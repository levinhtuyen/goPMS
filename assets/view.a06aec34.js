import{Q as S}from"./QDate.804040fd.js";import{Q as x}from"./QPopupProxy.9996c4ad.js";import{av as I,_ as F,r as y,C as Q,a as R,K as D,F as d,L as A,M as o,I as r,R as n,N as a,G as f,U as T,T as E,bo as O,aF as u}from"./index.7efcbe86.js";import{a as M}from"./QMenu.b19dfcca.js";import{Q as V}from"./QInnerLoading.5fef3982.js";import{a as U,c as m,Q as p}from"./QTable.4cc8e1c9.js";import{Q as C}from"./QPagination.a48c1bef.js";import{u as P}from"./useI18n.6b7b36de.js";import{b as X,e as v,d as q,c as B}from"./axiosClient.a0ee23b9.js";import{Q as K}from"./queryKeys.832af9fa.js";import{a as L}from"./useFormat.349e799c.js";import{n as j}from"./useCreateDate.6141d343.js";import{d as c}from"./date.2d51ed98.js";import"./use-cache.b0833c75.js";import"./position-engine.4a23d733.js";import"./selection.6afffe69.js";import"./QList.e5651779.js";import"./QSelect.8edab530.js";import"./QItemLabel.938a9258.js";import"./rtl.4b414a6d.js";const z=async({queryKey:l})=>{const[,i]=l;if((i==null?void 0:i.dateFrom)&&(i==null?void 0:i.dateTo)){const{data:s}=await X.get("/report/getChangeRoomReportList",{params:i});return s.data}},G=(l,i)=>{const s=[K.CHANGE_ROOM_REPORT,l];return I(s,z,{enabled:i,select:t=>t})};const Y={setup(){const{t:l}=P(),i=y(Date.now()),s=Q({page:1,limit:10,dateFrom:Number(c.formatDate(i.value,"X")),dateTo:Number(c.formatDate(i.value,"X"))}),{data:t,isFetching:N}=G(s,!0),w=y(null),b=y(0),h=()=>{w==null||w.value.show()},g=R({get:()=>({from:s.dateFrom?c.formatDate(new Date(s.dateFrom*1e3),v):"",to:s.dateTo?c.formatDate(new Date(s.dateTo*1e3),v):""}),set:_=>{b.value=0,_?(s.dateFrom=Number(c.formatDate(new Date(_.from),"X"))||Number(c.formatDate(new Date(_),"X")),s.dateTo=Number(c.formatDate(new Date(_.to),"X"))||Number(c.formatDate(new Date(_),"X"))):s.dateFrom=s.dateTo=null,e()}}),k=R(()=>[{name:"no",label:l("no"),align:"left",field:""},{name:"bookingNo",label:l("booking_no"),align:"left",field:"bookingNo"},{name:"bookingStatusSn",align:"left",label:l("booking_status"),field:"bookingStatusSn"},{name:"staffName",align:"left",label:l("guest_name"),field:"staffName"},{name:"roomTypeName",align:"left",label:l("room_types"),field:"roomTypeName"},{name:"oldRoomName",align:"left",label:l("old_rooms"),field:"oldRoomName"},{name:"newRoomName",align:"left",label:l("new_rooms"),field:"newRoomName"},{name:"checkIn",align:"left",label:l("arrival_date_time"),field:"checkIn"},{name:"checkOut",align:"left",label:l("departure_date_time"),field:"checkOut"},{name:"reason",align:"left",label:l("reason"),field:"reason"},{name:"createTime",align:"left",label:l("changed_at_by"),field:"createTime"}]),e=()=>{s.page=1};return{t:l,columns:k,data:t,isFetching:N,formatIndexTable:L,dateRangeType:b,onOpenDatePopUp:h,qDateRef:w,dateRange:g,FORMAT_DATE_UI:q,FORMAT_DATE_TIME_UI:B,FORMAT_DATE_PICKER:v,newDateStamp:j,formValues:s,date:c}}},H={class:"row q-mb-md"},J={class:"text-h5 text-bold"},W={class:"row q-mb-md"},Z={key:0,class:"self-center full-width no-outline",tabindex:"0"},$={class:"relative-position"},ee={lass:"full-width","full-height":"",class:"q-mt-md row justify-center"},te={key:0},oe={key:0,class:"text-orange-11"},ae={key:1,class:"text-green-11"},ne={key:2,class:"text-grey-11"},le={key:3,class:"text-deep-orange-11"},ie={key:4,class:"text-amber-11"},se={key:5,class:"text-blue-11"},re={class:"slice-tooltip"},me=["data-title"],de={class:"q-mt-md row justify-end"};function ce(l,i,s,t,N,w){const b=D("router-link"),h=D("pms-sections");return d(),A(h,null,{header:o(()=>[r("div",H,[r("div",J,n(t.t("change_room_report")),1)]),r("div",W,[r("div",null,[a(M,{placeholder:"Select date time",dense:"","stack-label":"",filled:"",onFocus:t.onOpenDatePopUp},{control:o(()=>[t.dateRange.from&&t.dateRange.to?(d(),f("div",Z,n(t.date.formatDate(String(t.dateRange.from),t.FORMAT_DATE_UI))+" - "+n(t.date.formatDate(String(t.dateRange.to),t.FORMAT_DATE_UI)),1)):T("v-if",!0)]),prepend:o(()=>[a(E,{name:"event",class:"no-pointer-events"},{default:o(()=>[a(x,{ref:"qDateRef","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(S,{modelValue:t.dateRange,"onUpdate:modelValue":i[0]||(i[0]=g=>t.dateRange=g),range:""},null,8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["onFocus"])])])]),default:o(()=>{var g,k;return[r("div",$,[a(V,{showing:t.isFetching,label:"Please","label-class":"text-teal","label-style":"font-size:1.1em"},{default:o(()=>[r("div",ee,[a(O,{color:"negative",thickness:2,size:"2em"})])]),_:1},8,["showing"]),t.isFetching?T("v-if",!0):(d(),f("div",te,[a(p,{"rows-per-page-options":[0],rows:(g=t.data)==null?void 0:g.changeRoomReportList,columns:t.columns,"hide-pagination":"","hide-bottom":"","row-key":"no"},{body:o(e=>[a(U,{props:e},{default:o(()=>[a(m,{key:"no",props:e},{default:o(()=>[u(n(t.formatIndexTable(t.formValues.page,e.rowIndex)),1)]),_:2},1032,["props"]),a(m,{key:"bookingNo",props:e},{default:o(()=>{var _;return[a(b,{style:{"text-decoration":"none"},class:"custom-link text-negative",to:{name:"BookingDetails",params:{sn:(_=e.row)==null?void 0:_.bookingSn}}},{default:o(()=>[u(n(e.row.bookingNo),1)]),_:2},1032,["to"])]}),_:2},1032,["props"]),a(m,{key:"bookingStatusSn",props:e},{default:o(()=>[e.row.bookingStatusSn===1?(d(),f("div",oe,n(e.row.bookingStatusName),1)):e.row.bookingStatusSn===2?(d(),f("div",ae,n(e.row.bookingStatusName),1)):e.row.bookingStatusSn===3?(d(),f("div",ne,n(e.row.bookingStatusName),1)):e.row.bookingStatusSn===4?(d(),f("div",le,n(e.row.bookingStatusName),1)):e.row.bookingStatusSn===5?(d(),f("div",ie,n(e.row.bookingStatusName),1)):e.row.bookingStatusSn===6?(d(),f("div",se,n(e.row.bookingStatusName),1)):T("v-if",!0)]),_:2},1032,["props"]),a(m,{key:"staffName",props:e},{default:o(()=>[u(n(e.row.staffName),1)]),_:2},1032,["props"]),a(m,{key:"roomTypeName",props:e},{default:o(()=>[u(n(e.row.roomTypeName),1)]),_:2},1032,["props"]),a(m,{key:"oldRoomName",props:e},{default:o(()=>[u(n(e.row.oldRoomName),1)]),_:2},1032,["props"]),a(m,{key:"newRoomName",props:e},{default:o(()=>[u(n(e.row.newRoomName),1)]),_:2},1032,["props"]),a(m,{key:"checkIn",props:e},{default:o(()=>[u(n(t.newDateStamp(e.row.checkIn,t.FORMAT_DATE_TIME_UI)),1)]),_:2},1032,["props"]),a(m,{key:"checkOut",props:e},{default:o(()=>[u(n(t.newDateStamp(e.row.checkOut,t.FORMAT_DATE_TIME_UI)),1)]),_:2},1032,["props"]),a(m,{key:"reason",props:e},{default:o(()=>[r("div",re,[r("div",{"data-title":e.row.reason},n(e.row.reason),9,me)])]),_:2},1032,["props"]),a(m,{key:"createTime",props:e},{default:o(()=>[r("div",null,n(t.newDateStamp(e.row.createTime,t.FORMAT_DATE_TIME_UI)),1),r("div",null,n(e.row.staffName),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),r("div",de,[a(C,{modelValue:t.formValues.page,"onUpdate:modelValue":i[1]||(i[1]=e=>t.formValues.page=e),color:"negative",max:((k=t.data)==null?void 0:k.meta.lastPage)||1,"max-pages":5,"boundary-numbers":"","direction-links":"",push:""},null,8,["modelValue","max"])])]))])]}),_:1})}var Ee=F(Y,[["render",ce],["__scopeId","data-v-1b91c5f1"],["__file","D:/gopms-web/src/modules/report/change-room-report/view.vue"]]);export{Ee as default};
